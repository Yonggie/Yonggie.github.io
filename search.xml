<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>FATEè”é‚¦å­¦ä¹ centosæˆåŠŸéƒ¨ç½²æ­¥éª¤</title>
      <link href="/2023/02/27/FATE%E5%AE%89%E8%A3%85/"/>
      <url>/2023/02/27/FATE%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://fate.readthedocs.io/en/latest/deploy/standalone-deploy/#1-descriptionã€‚">https://fate.readthedocs.io/en/latest/deploy/standalone-deploy/#1-descriptionã€‚</a></p><h1 id="å®‰è£…è¿‡ç¨‹"><a href="#å®‰è£…è¿‡ç¨‹" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h1><p>æ–‡æ¡£ä¸Šå†™ç€ç¡®å®šç‰ˆæœ¬<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export version=1.7.0</span><br></pre></td></tr></table></figure><br><strong>ä½†æ˜¯ä½ åˆ«çœŸçš„ç”¨1.7.0å•Šï¼</strong> ï¼Œ1.7.0å·²ç»æ˜¯å¾ˆè€çš„ç‰ˆæœ¬äº†â€¦â€¦<br>ä¸ç„¶å·¨å‘ï¼ˆæˆ‘å·²ç»äº²èº«ç»å†è¿‡äº†ï¼Œæ‚²ï¼‰ã€‚<br>é¦–å…ˆè¦æŸ¥ä¸€æŸ¥ç°åœ¨æ¯”è¾ƒæ–°çš„ç‰ˆæœ¬æ˜¯ä»€ä¹ˆï¼Œç›®å‰2023å¹´2æœˆæˆ‘æŸ¥åˆ°çš„æ¯”è¾ƒæ–°çš„æ˜¯1.10.0ã€‚<br>æ‰€ä»¥æˆ‘<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export version=1.10.0</span><br></pre></td></tr></table></figure><br>è·å¾—å®‰è£…åŒ…ï¼Œè§£å‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://webank-ai-1251170195.cos.ap-guangzhou.myqcloud.com/fate/$&#123;version&#125;/release/standalone_fate_install_$&#123;version&#125;_release.tar.gz;</span><br><span class="line">tar -xzvf standalone_fate_install_$&#123;version&#125;_release.tar.gz</span><br><span class="line"></span><br></pre></td></tr></table></figure><br>ç„¶åinitä¸€ä¸‹ï¼Œå®‰è£…ã€‚<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd standalone_fate_install_$&#123;version&#125;_release;</span><br><span class="line">bash bin/init.sh init</span><br></pre></td></tr></table></figure><br>å®‰è£…åå‡ºç°<br><img src="https://img-blog.csdnimg.cn/d60235f9b31c4005b427bc2de59c38d0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä½†æ˜¯æˆ‘è¿™é‡Œé™¤äº†è¿™ä¸ªï¼Œè¿˜æœ‰ä¸€äº›failçš„ä»»åŠ¡ï¼Œæš‚æ—¶ä¸ç®¡ä»–ã€‚</p><p>ç„¶åæ£€æŸ¥ä¸‹<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash bin/init.sh status</span><br></pre></td></tr></table></figure><br>è¾“å‡ºä¸€äº›configå’Œè¿è¡ŒçŠ¶æ€ï¼Œçœ‹åˆ°ç¡®å®æ²¡æœ‰å¯åŠ¨ã€‚</p><p>ç„¶åå¯åŠ¨<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash bin/init.sh start</span><br></pre></td></tr></table></figure><br>ä¼šç»è¿‡è®¸å¤šè®¸å¤šçš„<code>check process by http port and grpt port</code><br>æœ€åè¾“å‡ºçš„<code>service start successfully</code>ã€‚<br><strong>ä½†æ˜¯ä»–å¯èƒ½åœ¨å‰é¢å…ˆè¾“å‡ºfailedï¼Œåé¢è¿˜ä¼šè¾“å‡ºsuccessâ€¦â€¦</strong><br>æ£€æŸ¥ä¸€ä¸‹å§ï¼Œæˆ‘æ˜¯æ²¡æœ‰å‡ºç°fail</p><p>ç„¶åæ‰§è¡Œå®˜æ–¹æ–‡æ¡£çš„testing<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flow test toy -gid 10000 -hid 10000</span><br></pre></td></tr></table></figure><br>å¦‚æœä¸æˆåŠŸï¼Œä¼šè¿”å›<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;retcode&quot;: 100,</span><br><span class="line">    &quot;retmsg&quot;: &quot;Connection refused, Please check if the fate flow service is started&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æˆ–è€…torchå‡ºç°é”™è¯¯æˆ–è€…å…¶ä»–pythonåŒ…æˆ–è€…åº“å‡ºç°é”™è¯¯ã€‚<br>æˆ‘è‡ªå·±æ˜¯å‡ºç°äº†<code>module â€˜libâ€˜ has no attribute â€˜OpenSSL_add_all_algorithmsâ€˜</code>ï¼Œæ˜¯ç”±äºcryptographyåŒ…å¤ªæ–°äº†ï¼Œé™ä¸€ä¸‹çº§ï¼Œæˆ‘å‚è€ƒäº†<a href="https://blog.csdn.net/m0_67425175/article/details/129124597#:~:text=module%20%E2%80%98lib%E2%80%99%20has%20no%20attribute,%27OpenSSL_add_all_algorithms%E2%80%99%E5%87%BA%E7%8E%B0%E8%BF%99%E4%B8%AA%E9%97%AE%E9%A2%98%E6%98%AF%E5%9B%A0%E4%B8%BA%E4%BD%A0%E8%AF%B4%E5%AE%89%E8%A3%85%E7%9A%84%20cryptography%E5%BA%93%E4%B8%8E%E4%BD%A0%E7%8E%B0%E5%9C%A8%E7%9A%84%E4%BD%BF%E7%94%A8%E7%9A%84%E7%8E%AF%E5%A2%83%E4%B8%8D%E5%85%BC%E5%AE%B9%E5%AF%BC%E8%87%B4%E7%9A%84%EF%BC%8C%E5%8F%AF%E8%83%BD%E6%98%AF%E5%9B%A0%E4%B8%BAcryptography%E7%9A%84%E7%89%88%E6%9C%AC%E5%A4%AA%E9%AB%98%EF%BC%8C%E9%9C%80%E8%A6%81%E8%BF%9B%E8%A1%8C%E9%99%8D%E7%BA%A7%20pip%20install%20cryptography%3D%3D38.0.4">è¿™ä¸ª</a>ï¼ŒæˆåŠŸè¿è¡Œäº†<code>toy test</code><br>æˆåŠŸåä¼šè¿”å›è¿™æ ·<br><img src="https://img-blog.csdnimg.cn/349d5d871d584305a08c20cf3f257ca1.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è¿™æ ·FATEæ¡†æ¶å°±å¯åŠ¨èµ·æ¥äº†ã€‚</p><p>ä¸‹ä¸€ç¯‡å†æ•™ä¸€ä¸‹ä½¿ç”¨Pythonè¿›è¡Œæ¡†æ¶çš„å¼€å‘ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>windowså³é”®æ·»åŠ â€œä½¿ç”¨vscodeæ‰“å¼€â€</title>
      <link href="/2023/02/22/win%E5%8F%B3%E9%94%AE%E6%B7%BB%E5%8A%A0vscode%E6%89%93%E5%BC%80/"/>
      <url>/2023/02/22/win%E5%8F%B3%E9%94%AE%E6%B7%BB%E5%8A%A0vscode%E6%89%93%E5%BC%80/</url>
      
        <content type="html"><![CDATA[<ol><li>æ–°å»ºxx.regæ–‡ä»¶å¹¶ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å¤åˆ¶ä¸‹æ–¹æ–‡æœ¬ <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\*\shell\VSCode]</span><br><span class="line">@=&quot;Open with Code&quot;</span><br><span class="line">&quot;Icon&quot;=&quot;E:\\Microsoft VS Code\\Code.exe&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\*\shell\VSCode\command]</span><br><span class="line">@=&quot;\&quot;E:\\Microsoft VS Code\\Code.exe\&quot; \&quot;%1\&quot;&quot;</span><br><span class="line"></span><br><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\shell\VSCode]</span><br><span class="line">@=&quot;Open with Code&quot;</span><br><span class="line">&quot;Icon&quot;=&quot;E:\\Microsoft VS Code\\Code.exe&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\shell\VSCode\command]</span><br><span class="line">@=&quot;\&quot;E:\\Microsoft VS Code\\Code.exe\&quot; \&quot;%V\&quot;&quot;</span><br><span class="line"></span><br><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\VSCode]</span><br><span class="line">@=&quot;Open with Code&quot;</span><br><span class="line">&quot;Icon&quot;=&quot;E:\\Microsoft VS Code\\Code.exe&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\VSCode\command]</span><br><span class="line">@=&quot;\&quot;E:\\Microsoft VS Code\\Code.exe\&quot; \&quot;%V\&quot;&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>æŠŠæ‰€æœ‰è·¯å¾„æ›¿æ¢æˆä½ çš„è·¯å¾„</li><li>ä¿å­˜ååŒå‡»è¿è¡Œï¼Œä¸€è·¯ç¡®å®šå³å¯å®Œæˆã€‚</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>T-SNE PCA UMAPçš„é™ç»´å¯è§†åŒ–æ¯”è¾ƒ</title>
      <link href="/2022/11/03/tsne/"/>
      <url>/2022/11/03/tsne/</url>
      
        <content type="html"><![CDATA[<h1 id="T-SNE"><a href="#T-SNE" class="headerlink" title="T-SNE"></a>T-SNE</h1><p><a href="https://github.com/CannyLab/tsne-cuda">2017å¹´ tsne cuda</a><br><a href="https://gitee.com/chixiangbo/tsne-cuda">gitee tsne cuda</a><br><a href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html">sklearn api</a></p><p>æ ¹æ®ä»¥ä¸Šçš„å·²ç»é›†æˆå¥½çš„apiï¼Œæœ‰ä»¥ä¸‹ç¤ºä¾‹ï¼š<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.manifold <span class="keyword">import</span> TSNE</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># Random state.</span></span><br><span class="line">RS = <span class="number">20150101</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"> </span><br><span class="line">X = np.random.rand(<span class="number">100</span>,<span class="number">20</span>)</span><br><span class="line">y = np.random.randint(<span class="number">0</span>,<span class="number">10</span>,<span class="number">100</span>)</span><br><span class="line">reduced_x = TSNE(random_state=RS).fit_transform(X)</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>, <span class="number">8</span>))</span><br><span class="line"><span class="comment"># ax = plt.subplot(aspect=&#x27;equal&#x27;)</span></span><br><span class="line">sc = plt.scatter(reduced_x[:,<span class="number">0</span>], reduced_x[:,<span class="number">1</span>],c=y)<span class="comment">#,cmap=&#x27;Spectral&#x27;)#, lw=0, s=40)</span></span><br><span class="line"><span class="comment"># plt.xlim(-25, 25)</span></span><br><span class="line"><span class="comment"># plt.ylim(-25, 25)</span></span><br><span class="line">plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line"><span class="comment"># ax.axis(&#x27;tight&#x27;)</span></span><br><span class="line">plt.savefig(<span class="string">&#x27;tsne-generated.png&#x27;</span>, dpi=<span class="number">120</span>)</span><br><span class="line"><span class="comment"># plt.show()</span></span><br></pre></td></tr></table></figure><br>å¯ä»¥å¾—åˆ°<br><img src="https://img-blog.csdnimg.cn/7de8eb69467648659e9173f68fcd80e7.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="PCAé™ç»´"><a href="#PCAé™ç»´" class="headerlink" title="PCAé™ç»´"></a>PCAé™ç»´</h1><h1 id="UMAPé™ç»´"><a href="#UMAPé™ç»´" class="headerlink" title="UMAPé™ç»´"></a>UMAPé™ç»´</h1>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Differences between Knowledge Graph and Graph Neural Network</title>
      <link href="/2022/10/18/difference_KG_GNN/"/>
      <url>/2022/10/18/difference_KG_GNN/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒï¼š<a href="https://www.bilibili.com/video/BV16u411z7ss/">https://www.bilibili.com/video/BV16u411z7ss/</a></p><p><img src="https://img-blog.csdnimg.cn/f50527c575e8424eba4273034e99d7eb.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h1><p>å¯¹äºGNNï¼š</p><ul><li><strong>ç›®çš„</strong>æ˜¯representation learningè¡¨ç¤ºå­¦ä¹ ï¼Œç›®çš„æ˜¯å¯¹å›¾ä¸­æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œå‘é‡è¡¨ç¤ºï¼›</li><li><strong>åº”ç”¨åœºæ™¯</strong>æ˜¯æåº¦ç¨€ç–ã€æ®‹ç¼ºã€è§„æ¨¡åºå¤§çš„å›¾ç»“æ„æ•°æ®</li><li><strong>è§£å†³æ–¹å¼</strong>æ˜¯é€šè¿‡æ›´å¥½çš„è¡¨ç¤ºå­¦ä¹ åï¼Œè¿›è¡ŒèŠ‚ç‚¹å‘é‡çš„è·ç¦»åº¦é‡ã€‚</li></ul><p>å¯¹äºçŸ¥è¯†å›¾è°±ï¼š</p><ul><li><strong>ç›®çš„</strong>æ˜¯ä¸ºäº†<strong>çŸ¥è¯†æ¨ç†</strong>ï¼Œå¯¹çŸ¥è¯†è¿›è¡Œå»ºæ¨¡ï¼Œè€Œéå®ä½“ï¼Œå½¢æˆèƒ½å¤Ÿè¿ç§»çš„çŸ¥è¯†è¡¨ç¤ºä½“ç³»</li><li><strong>åœºæ™¯</strong>æ˜¯å…·æœ‰å¯è§£é‡Šæ€§çš„çŸ¥è¯†<strong>æ¨ç†</strong>ï¼Œå¤šç›®æ ‡ä¼˜åŒ–æ±‚è§£</li><li><strong>è§£å†³æ–¹å¼</strong>æ˜¯å–æ ·pathæˆ–è€…å­å›¾ä¼˜åŒ–ã€‚</li></ul><h1 id="è”ç³»"><a href="#è”ç³»" class="headerlink" title="è”ç³»"></a>è”ç³»</h1><p>éƒ½æ˜¯å›¾å½¢æ•°æ®ç»“æ„ï¼Œéƒ½éœ€è¦å¸å–è¾¹ä¿¡æ¯è¿›è¡Œæ¨æ–­/é¢„æµ‹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> knowledge graph, graph neural network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Differences between Knowledge Graph and Graph Neural Network</title>
      <link href="/2022/10/18/graph_dataset/"/>
      <url>/2022/10/18/graph_dataset/</url>
      
        <content type="html"><![CDATA[<ul><li><p><a href="https://blog.csdn.net/weixin_39373480/article/details/88742200?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-88742200-blog-93374216.pc_relevant_3mothn_strategy_recovery&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-88742200-blog-93374216.pc_relevant_3mothn_strategy_recovery&amp;utm_relevant_index=2#3__58">cora</a>ï¼Œæ–‡çŒ®æ•°æ®é›†ï¼Œå…±2708ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ˜¯æ–‡çŒ®ã€‚5429æ¡è¾¹</p></li><li><p>(citeseer)[<a href="https://linqs-data.soe.ucsc.edu/public/lbc/citeseer.tgz]ï¼Œ3312ä¸ªèŠ‚ç‚¹ï¼Œ4732æ¡è¾¹ï¼Œå¯ç”¨äºåˆ†ç±»">https://linqs-data.soe.ucsc.edu/public/lbc/citeseer.tgz]ï¼Œ3312ä¸ªèŠ‚ç‚¹ï¼Œ4732æ¡è¾¹ï¼Œå¯ç”¨äºåˆ†ç±»</a></p></li><li><p><a href="http://snap.stanford.edu/graphsage/ppi.zip">PPI</a>ï¼Œè›‹ç™½ä¸è›‹ç™½æ•°æ®é›†ï¼ŒPPIæ•°æ®é›†å…±24å¼ å›¾ï¼Œæ¯å¼ å›¾å¯¹åº”ä¸åŒçš„äººä½“ç»„ç»‡ï¼Œå¹³å‡æ¯å¼ å›¾æœ‰2371ä¸ªèŠ‚ç‚¹ï¼Œå…±56944ä¸ªèŠ‚ç‚¹818716æ¡è¾¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç‰¹å¾é•¿åº¦ä¸º50ï¼Œå…¶ä¸­åŒ…å«ä½ç½®åŸºå› é›†ï¼ŒåŸºåºé›†å’Œå…ç–«å­¦ç‰¹å¾ã€‚åŸºå› æœ¬ä½“åŸºä½œä¸ºlabel(æ€»å…±121ä¸ª)ï¼Œlabelä¸æ˜¯one-hotç¼–ç ã€‚</p></li></ul><h1 id="â€œå¤§â€æ•°æ®é›†"><a href="#â€œå¤§â€æ•°æ®é›†" class="headerlink" title="â€œå¤§â€æ•°æ®é›†"></a>â€œå¤§â€æ•°æ®é›†</h1><ul><li><a href="https://paperswithcode.com/dataset/reddit">Reddit</a> In total this dataset contains 232,965 posts with an average degree of 492.</li></ul><p>æ›´å¤šå¯å‚è€ƒ <a href="https://blog.csdn.net/w55100/article/details/115911550">https://blog.csdn.net/w55100/article/details/115911550</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> graph learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­æ–‡è¿‘ä¹‰çŸ­è¯­åˆå¹¶å®éªŒ</title>
      <link href="/2022/10/11/chinese_sentence_sim/"/>
      <url>/2022/10/11/chinese_sentence_sim/</url>
      
        <content type="html"><![CDATA[<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>æœ€è¿‘è¦åšä¸€ä¸ªæ–‡æœ¬åˆ°graphçš„æ•°æ®é›†ï¼Œé‡Œé¢æœ‰ä¸å°‘ä¸åŒå­—ä½†åŒä¹‰çš„å°æ–‡æœ¬æ®µï¼Œæƒ³ç®€å•ç”¨æ–‡æœ¬ç›¸ä¼¼åº¦çš„æ–¹å¼æŠŠä»–ä»¬å½’åˆ°ä¸€ç±»é‡Œé¢ã€‚</p><h1 id="æ–¹å¼"><a href="#æ–¹å¼" class="headerlink" title="æ–¹å¼"></a>æ–¹å¼</h1><ol><li>ç›´æ¥è°ƒç”¨hanlpçš„sentence simï¼Œå¸®å¿™è§£å†³</li><li>ç”¨ä¸­æ–‡transformeråšsentence embeddingï¼Œåç”¨è·ç¦»å‡½æ•°è®¾å®šé˜ˆå€¼è§£å†³ã€‚</li><li>ç›´æ¥ç”¨hugging faceçš„transformerçš„é«˜çº§apiï¼Œä¹Ÿæ˜¯ç›´æ¥ç«¯åˆ°ç«¯å¸®å¿™è§£å†³ã€‚</li></ol><h1 id="Hanlp"><a href="#Hanlp" class="headerlink" title="Hanlp"></a>Hanlp</h1><p>æ ¹æ®<a href="https://github.com/hankcs/HanLP/blob/doc-zh/plugins/hanlp_demo/hanlp_demo/zh/sts_stl.ipynb">è¿™é‡Œ</a>ï¼Œ<code>pip install hanlp</code>åï¼Œç›´æ¥<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hanlp</span><br><span class="line">sts = hanlp.load(hanlp.pretrained.sts.STS_ELECTRA_BASE_ZH)</span><br><span class="line"></span><br><span class="line">sentence_list=make_sentence_list()</span><br><span class="line"><span class="comment"># sentence_list=[</span></span><br><span class="line"><span class="comment">#     (&#x27;çœ‹å›¾çŒœä¸€ç”µå½±å&#x27;, &#x27;çœ‹å›¾çŒœç”µå½±&#x27;),</span></span><br><span class="line"><span class="comment">#     (&#x27;æ— çº¿è·¯ç”±å™¨æ€ä¹ˆæ— çº¿ä¸Šç½‘&#x27;, &#x27;æ— çº¿ä¸Šç½‘å¡å’Œæ— çº¿è·¯ç”±å™¨æ€ä¹ˆç”¨&#x27;),</span></span><br><span class="line"><span class="comment">#     (&#x27;åŒ—äº¬åˆ°ä¸Šæµ·çš„åŠ¨è½¦ç¥¨&#x27;, &#x27;ä¸Šæµ·åˆ°åŒ—äº¬çš„åŠ¨è½¦ç¥¨&#x27;),</span></span><br><span class="line"><span class="comment"># ]</span></span><br><span class="line">res=sts(sentence_list)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure></p><p>è¯¥è¯´ä¸è¯´ï¼Œæˆ‘ä¸€å…±æ‰1kå·¦å³ä¸ªå°å¥å­ï¼Œå…±$C_{1900}^2$ä¸ªï¼Œinferenceç«Ÿç„¶ç”¨æ—¶58.48093847433726åˆ†é’Ÿï¼Œå¤ªæ…¢äº†ï¼ï¼</p><h1 id="transformer-end2end"><a href="#transformer-end2end" class="headerlink" title="transformer end2end"></a>transformer end2end</h1><p><code>pip install transformer</code>åï¼Œ<br>æœ¬æ¥æƒ³å·æ‡’ç›´æ¥ç”¨pipelineçš„ï¼Œ<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AutoModelForTokenClassification,AutoTokenizer,pipeline</span><br><span class="line">model_id=<span class="string">&#x27;uer/sbert-base-chinese-nli&#x27;</span></span><br><span class="line">scorer=pipeline(<span class="string">&quot;sentence-similarity&quot;</span>,model=model_id)</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯æŠ¥é”™ï¼Œå˜»å˜»ï¼š<br><code>&quot;Unknown task sentence-similarity, available tasks are [&#39;audio-classification&#39;, &#39;automatic-speech-recognition&#39;, &#39;conversational&#39;, &#39;document-question-answering&#39;, &#39;feature-extraction&#39;, &#39;fill-mask&#39;, &#39;image-classification&#39;, &#39;image-segmentation&#39;, &#39;image-to-text&#39;, &#39;ner&#39;, &#39;object-detection&#39;, &#39;question-answering&#39;, &#39;sentiment-analysis&#39;, &#39;summarization&#39;, &#39;table-question-answering&#39;, &#39;text-classification&#39;, &#39;text-generation&#39;, &#39;text2text-generation&#39;, &#39;token-classification&#39;, &#39;translation&#39;, &#39;visual-question-answering&#39;, &#39;vqa&#39;, &#39;zero-shot-classification&#39;, &#39;zero-shot-image-classification&#39;, &#39;translation_XX_to_YY&#39;]&quot;</code><br>è¡Œå§ï¼Œå†å·æ‡’ä¸‹ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½autotokenizerå’Œautomodelè§£å†³ã€‚</p><p>æ ¹æ®æˆ‘çš„<a href="https://yonggie.github.io/2022/10/11/huggingface_transformer_real_quickstart/">è¿™ç¯‡æ•™ç¨‹</a>ï¼Œæ‰¾åˆ°å¯¹åº”ä»»åŠ¡åé€‰æ‹©model idã€‚<br>æ‰¾åˆ°åï¼Œåªæœ‰ä¸¤ä¸ªæ¨¡å‹â€¦â€¦å¥½å®¶ä¼™ï¼Œå¤Ÿå°‘çš„ã€‚æ€ä¹ˆè¿ä¸ªexampleä¹Ÿæ²¡æœ‰â€¦â€¦<br><img src="https://img-blog.csdnimg.cn/fe47ba1ff779430d98d1f07316698603.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>éšä¾¿é€‰æ‹©ä¸€ä¸ªï¼Œç„¶åçœ‹ä¸‹å…¶ä»–è¯­è¨€çš„sentence similarityçš„exampleï¼š<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> scipy.spatial.distance <span class="keyword">import</span> cosine</span><br><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AutoModel, AutoTokenizer</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the model</span></span><br><span class="line">tokenizer = AutoTokenizer.from_pretrained(<span class="string">&quot;johngiorgi/declutr-small&quot;</span>)</span><br><span class="line">model = AutoModel.from_pretrained(<span class="string">&quot;johngiorgi/declutr-small&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Prepare some text to embed</span></span><br><span class="line">text = [</span><br><span class="line">    <span class="string">&quot;A smiling costumed woman is holding an umbrella.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;A happy woman in a fairy costume holds an umbrella.&quot;</span>,</span><br><span class="line">]</span><br><span class="line">inputs = tokenizer(text, padding=<span class="literal">True</span>, truncation=<span class="literal">True</span>, return_tensors=<span class="string">&quot;pt&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Embed the text</span></span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    sequence_output = model(**inputs)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Mean pool the token-level embeddings to get sentence-level embeddings</span></span><br><span class="line">embeddings = torch.<span class="built_in">sum</span>(</span><br><span class="line">    sequence_output * inputs[<span class="string">&quot;attention_mask&quot;</span>].unsqueeze(-<span class="number">1</span>), dim=<span class="number">1</span></span><br><span class="line">) / torch.clamp(torch.<span class="built_in">sum</span>(inputs[<span class="string">&quot;attention_mask&quot;</span>], dim=<span class="number">1</span>, keepdims=<span class="literal">True</span>), <span class="built_in">min</span>=<span class="number">1e-9</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Compute a semantic similarity via the cosine distance</span></span><br><span class="line">semantic_sim = <span class="number">1</span> - cosine(embeddings[<span class="number">0</span>], embeddings[<span class="number">1</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure></p><p>wocï¼Œæ˜é¢ä¸Šå†™çš„æ˜¯end2endï¼Œç»“æœè¿˜æ˜¯åªè¿”å›sentence embeddingâ€¦â€¦<br><strong>æ ¹æœ¬æ˜¯å‡çš„ç«¯åˆ°ç«¯â€¦â€¦</strong></p><h1 id="transformer-sentence-embedding"><a href="#transformer-sentence-embedding" class="headerlink" title="transformer sentence embedding"></a>transformer sentence embedding</h1><p>æ—¢ç„¶æ˜¯å‡çš„ç«¯åˆ°ç«¯ï¼Œé‚£æ²¡å¿…è¦é€‰æ‹©ç‰¹å®štaskçš„modeläº†ã€‚<br>ä¾‹å­ä¸Šä¸€éƒ¨åˆ†å·²ç»ç»™å‡ºæ¥äº†ï¼Œå¾ˆæ£’ï¼æ¢ä¸ªmodel idå°±è¡Œäº†ï¼Œçœ‹çœ‹ï¼Ÿ<br><img src="https://img-blog.csdnimg.cn/2944ceb230cf4fc6add2c5af96e9d1a2.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/24e6fd72e857482180b8b01da8140d11.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æœ‰é‚£ä¹ˆç‚¹æ„æ€å“ˆï¼ŒæŠŠé˜ˆå€¼æ”¾ä½äº›å¯ä»¥çœ‹çœ‹ã€‚<br>åˆ°æ­¤ï¼Œå¤„ç†éƒ¨åˆ†å°±ç»“æŸäº†ã€‚<br>æ¥ä¸‹æ¥å°±æ˜¯äººå·¥è®¾ç½®é˜ˆå€¼ï¼Œåˆå¹¶äº†ã€‚</p><h1 id="æœ€åé™„å¤„ç†çš„ä»£ç "><a href="#æœ€åé™„å¤„ç†çš„ä»£ç " class="headerlink" title="æœ€åé™„å¤„ç†çš„ä»£ç "></a>æœ€åé™„å¤„ç†çš„ä»£ç </h1><h2 id="hanlp"><a href="#hanlp" class="headerlink" title="hanlp"></a>hanlp</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hanlp</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_sentence_list</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;making sentence pair, waiting...&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    node_storage=pickle.load(<span class="built_in">open</span>(<span class="string">&#x27;path.pkl&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>))</span><br><span class="line">    syndromes=node_storage[<span class="string">&#x27;syndrome&#x27;</span>]</span><br><span class="line">    sentence_list=[]</span><br><span class="line">    <span class="keyword">for</span> sentence_pair <span class="keyword">in</span> combinations(syndromes,<span class="number">2</span>):</span><br><span class="line">        sentence_list.append(sentence_pair)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;pairs prepared&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> sentence_list</span><br><span class="line"></span><br><span class="line">scorer = hanlp.load(hanlp.pretrained.sts.STS_ELECTRA_BASE_ZH)</span><br><span class="line"></span><br><span class="line">sentence_list=make_sentence_list()</span><br><span class="line"><span class="comment"># sentence_list=[</span></span><br><span class="line"><span class="comment">#     (&#x27;çœ‹å›¾çŒœä¸€ç”µå½±å&#x27;, &#x27;çœ‹å›¾çŒœç”µå½±&#x27;),</span></span><br><span class="line"><span class="comment">#     (&#x27;æ— çº¿è·¯ç”±å™¨æ€ä¹ˆæ— çº¿ä¸Šç½‘&#x27;, &#x27;æ— çº¿ä¸Šç½‘å¡å’Œæ— çº¿è·¯ç”±å™¨æ€ä¹ˆç”¨&#x27;),</span></span><br><span class="line"><span class="comment">#     (&#x27;åŒ—äº¬åˆ°ä¸Šæµ·çš„åŠ¨è½¦ç¥¨&#x27;, &#x27;ä¸Šæµ·åˆ°åŒ—äº¬çš„åŠ¨è½¦ç¥¨&#x27;),</span></span><br><span class="line"><span class="comment"># ]</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;inferencing...&#x27;</span>)</span><br><span class="line">T1 = time.time()</span><br><span class="line">res=scorer(sentence_list)</span><br><span class="line">T2=time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;inference done, time:<span class="subst">&#123;(T2-T1)/<span class="number">60</span>&#125;</span>min&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="transformer-sentence-embedding-1"><a href="#transformer-sentence-embedding-1" class="headerlink" title="transformer sentence embedding"></a>transformer sentence embedding</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AutoModel, AutoTokenizer</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the model</span></span><br><span class="line">model_id=<span class="string">&#x27;bert-base-chinese&#x27;</span></span><br><span class="line">tokenizer = AutoTokenizer.from_pretrained(model_id)</span><br><span class="line"></span><br><span class="line">model = AutoModel.from_pretrained(model_id)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Prepare some text to embed</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_sentence_list</span>():</span><br><span class="line">    </span><br><span class="line">    node_storage=pickle.load(<span class="built_in">open</span>(<span class="string">&#x27;path.pkl&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>))</span><br><span class="line">    syndromes=<span class="built_in">sorted</span>(<span class="built_in">list</span>(node_storage[<span class="string">&#x27;syndrome&#x27;</span>]))</span><br><span class="line">    <span class="comment"># sentence_list=[]</span></span><br><span class="line">    <span class="comment"># for sentence_pair in combinations(syndromes,2):</span></span><br><span class="line">    <span class="comment">#     sentence_list.append(sentence_pair)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> syndromes</span><br><span class="line"></span><br><span class="line">text = make_sentence_list()</span><br><span class="line">input_data = tokenizer(text, padding=<span class="literal">True</span>, truncation=<span class="literal">True</span>, return_tensors=<span class="string">&quot;pt&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Embed the text</span></span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    sequence_output = model(**input_data)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Mean pool the token-level embeddings to get sentence-level embeddings</span></span><br><span class="line">embeddings = torch.<span class="built_in">sum</span>(</span><br><span class="line">    sequence_output * input_data[<span class="string">&quot;attention_mask&quot;</span>].unsqueeze(-<span class="number">1</span>), dim=<span class="number">1</span></span><br><span class="line">) / torch.clamp(torch.<span class="built_in">sum</span>(input_data[<span class="string">&quot;attention_mask&quot;</span>], dim=<span class="number">1</span>, keepdims=<span class="literal">True</span>), <span class="built_in">min</span>=<span class="number">1e-9</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Compute a semantic similarity via the cosine distance</span></span><br><span class="line"><span class="comment"># coss = torch.cosine_similarity(embeddings.unsqueeze(1),embeddings.unsqueeze(0),dim=-1)</span></span><br><span class="line">idxs=<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="built_in">len</span>(embeddings)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;calculating cosine similarity...&#x27;</span>)</span><br><span class="line">T1 = time.time()</span><br><span class="line">sentence_pair2cos=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> idx1,idx2 <span class="keyword">in</span> combinations(idxs,<span class="number">2</span>):</span><br><span class="line">    cos=torch.cosine_similarity(embeddings[idx1].unsqueeze(<span class="number">0</span>),embeddings[idx2].unsqueeze(<span class="number">0</span>)).item()</span><br><span class="line">    sentence_pair2cos[(text[idx1],text[idx2])]=cos</span><br><span class="line">T2=time.time()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;time:<span class="subst">&#123;T2-T1&#125;</span>sec\n\nSaving similarity as dict&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤ªå¤šã€å¤ªæ…¢ã€‚</span></span><br><span class="line"><span class="comment"># with open(&#x27;sentence_sim.dict&#x27;,&#x27;w&#x27;) as f:</span></span><br><span class="line"><span class="comment">#     f.write(&#x27;&#123;\n&#x27;)</span></span><br><span class="line"><span class="comment">#     for k,v in sentence_pair2cos.items():</span></span><br><span class="line"><span class="comment">#         f.write(f&quot;&#123;k&#125;:&#123;v&#125;,\n&quot;)</span></span><br><span class="line"><span class="comment">#     f.write(&#x27;&#125;\n&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sentence_sim_dict.pkl&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pickle.dump(sentence_pair2cos,f)</span><br><span class="line"><span class="comment"># print(coss.shape)</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>huggingface real quickstart</title>
      <link href="/2022/10/10/huggingface_transformer_real_quickstart/"/>
      <url>/2022/10/10/huggingface_transformer_real_quickstart/</url>
      
        <content type="html"><![CDATA[<h1 id="tokenizer"><a href="#tokenizer" class="headerlink" title="tokenizer"></a>tokenizer</h1><p>å¯¹äºsentenceè¦å…ˆåˆ†è¯ï¼Œå¯¹æ¯ä¸ªè¯åšä¸€ä¸ªword embeddingï¼Œè¿™ä¸ªè¿‡ç¨‹å«tokenizeï¼Œæ‰€ä»¥ç”¨tokenizerè¿™ä¸ªç±»ã€‚</p><p>é‚£å¯¹äºä¸­æ–‡æ¥è¯´ï¼Œé€‰ç”¨ä»€ä¹ˆtokenizerå¥½ï¼Ÿ<br>å¯ä»¥è§<a href="https://github.com/lonePatient/awesome-pretrained-chinese-nlp-models">https://github.com/lonePatient/awesome-pretrained-chinese-nlp-models</a></p><p>å‡å®šæˆ‘è¦ç”¨<code>nlptown/bert-base-multilingual-uncased-sentiment</code>è¿™ä¸ªæ¨¡å‹ï¼Œåˆ™<code>from_pretrain</code>æ˜¯å¾ˆé‡è¦çš„æ–¹æ³•ï¼Œä½ éœ€è¦ä¼ å…¥ä¸€ä¸ªmode idæ¥ç¡®å®štokenizerçš„é€‚é…çš„æ¨¡å‹ã€‚<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AutoTokenizer</span><br><span class="line"></span><br><span class="line">model_name = <span class="string">&quot;nlptown/bert-base-multilingual-uncased-sentiment&quot;</span></span><br><span class="line">tokenizer = AutoTokenizer.from_pretrained(model_name)</span><br><span class="line">encoding = tokenizer(<span class="string">&quot;We are very happy to show you the ğŸ¤— Transformers library.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(encoding)</span><br></pre></td></tr></table></figure></p><p>é‚£å¦‚ä½•ç¡®å®šé€‰ç”¨çš„modelæ˜¯å¦åœ¨huggingfaceçš„transformeråº“é‡Œé¢ï¼Ÿ<a href="https://huggingface.co/docs/transformers/v4.22.2/en/model_doc/auto#transformers.AutoTokenizer.from_pretrained.pretrained_model_name_or_path">å¯è¯¦è§è¿™é‡Œ</a><br><img src="https://img-blog.csdnimg.cn/5e90887ff51a4beabca663284031a105.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">å¯¹äº<code>model id</code>ï¼Œå»huggingface documentationï¼Œç•Œé¢ä¸­<br><img src="https://img-blog.csdnimg.cn/2ff024ae7128472097b46fcaabaa55a4.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">å°±å¯ä»¥æ‰¾å¾—åˆ°<code>model id</code>äº†ï¼Œç‚¹å¼€åå·¦ä¾§æœ‰å„ç§é€‰é¡¹ï¼Œå¤ªå…¨äº†ï¼Œä»–çœŸçš„ï¼Œæˆ‘å“­æ­»â€¦â€¦<br><img src="https://img-blog.csdnimg.cn/d2087de320d645a999c0608353c3470a.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="ä¸­æ–‡tokenizer"><a href="#ä¸­æ–‡tokenizer" class="headerlink" title="ä¸­æ–‡tokenizer"></a>ä¸­æ–‡tokenizer</h1><p>ä»¥<code>ckiplab/albert-base-chinese-ner</code>ä¸ºä¾‹</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AlbertTokenizer,AlbertModel,AutoTokenizer</span><br><span class="line"></span><br><span class="line">tokenizer=AutoTokenizer.from_pretrained(<span class="string">&#x27;ckiplab/albert-base-chinese-ner&#x27;</span>)</span><br><span class="line">encoding=tokenizer.encode(<span class="string">&#x27;æˆ‘è‰ä½ æ˜¯çœŸçš„ç‰›é€¼&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(encoding)</span><br><span class="line"><span class="built_in">print</span>(tokenizer.decode(encoding))</span><br></pre></td></tr></table></figure><p>è¾“å‡º<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[101, 2769, 5770, 872, 3221, 4696, 4638, 4281, 6873, 102]</span><br><span class="line">[CLS] æˆ‘ è‰ ä½  æ˜¯ çœŸ çš„ ç‰› é€¼ [SEP]</span><br></pre></td></tr></table></figure><br>å¯ä»¥çœ‹åˆ°æ¯ä¸ªè¯å¯¹åº”äº†vocabé‡Œé¢çš„ä¸€ä¸ªidï¼Œæ•´ä¸ªå¥å­å·²ç»è¢«tokenizeäº†ã€‚ï¼ˆä¸­æ–‡é‡Œä¸ä¸€å®šä¸€ä¸ªidéƒ½åªå¯¹åº”ä¸€ä¸ªå­—å“¦ï¼Œä¹Ÿå¯èƒ½ä¸€ä¸ªidå¯¹åº”2ä¸ªå­—ã€‚ï¼‰</p><h1 id="model"><a href="#model" class="headerlink" title="model"></a>model</h1><p>é€‰å®šä»»åŠ¡ï¼ˆä»å·¦ä¾§çš„tagé‡Œé¢ï¼‰åï¼Œç±»ä¼¼çš„ï¼Œmodelé‡Œé¢ä¹Ÿæœ‰<code>AutoModel+ä»»åŠ¡åç§°</code>ç±»ï¼Œä¹Ÿæ˜¯è°ƒç”¨from_pretrainï¼Œmodel idå†™ä¸€æ ·çš„å°±å¯ä»¥äº†ã€‚<br>ä»¥NERä»»åŠ¡ä¸ºä¾‹ï¼Œå·¦è¾¹tagçš„åå­—å«TokenClassificationï¼Œå¯¼å…¥<code>AutoModelForTokenClassification</code>ï¼Œç„¶å<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sentence=<span class="string">&#x27;èˆŒè´¨æ·¡çº¢ï¼Œè‹”è–„ç™½ï¼Œå³ä¾§ç˜€æ–‘è¾ƒæ·¡ã€‚&#x27;</span></span><br><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> AutoModelForTokenClassification,AutoTokenizer</span><br><span class="line"></span><br><span class="line">tokenizer=AutoTokenizer.from_pretrained(<span class="string">&#x27;ckiplab/albert-base-chinese-ner&#x27;</span>)</span><br><span class="line">encoding=tokenizer(<span class="string">&#x27;èˆŒè´¨æ·¡çº¢ï¼Œè‹”è–„ç™½ï¼Œå³ä¾§ç˜€æ–‘è¾ƒæ·¡ã€‚&#x27;</span>,return_tensors=<span class="string">&#x27;pt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">model = AutoModelForTokenClassification.from_pretrained(<span class="string">&quot;ckiplab/albert-base-chinese-ner&quot;</span>)</span><br><span class="line">results=model(**encoding)</span><br><span class="line"><span class="built_in">print</span>(results)</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„tokenizerå’Œmodelçš„<code>from_pretrain</code>çš„<code>model id</code>å‚æ•°è¦å¯¹åº”ä¸€è‡´ã€‚</p><p>from_pretrainedä¸‹è½½çš„ä¸œè¥¿åœ¨å“ªé‡Œï¼Ÿ<br>linuxä¸Šï¼Œåœ¨<code>/home/yourname/.cache/torch/transformers</code>ï¼Œæ‰€ä»¥å¦‚æœç½‘ç»œä¸å¥½ï¼Œå¯ä»¥æ‰‹åŠ¨ä¸‹è½½åæ”¾å…¥é‚£é‡Œã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Chinese Segment Tools in 2022(2022å¹´çš„ä¸­æ–‡åˆ†è¯å·¥å…·)</title>
      <link href="/2022/09/18/chinese_seg/"/>
      <url>/2022/09/18/chinese_seg/</url>
      
        <content type="html"><![CDATA[<h1 id="Hanlp"><a href="#Hanlp" class="headerlink" title="Hanlp"></a><a href="https://github.com/hankcs/HanLP/tree/doc-zh">Hanlp</a></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install hanlp</span><br></pre></td></tr></table></figure><p>å<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hanlp</span><br><span class="line">hanlp.pretrained.tok.ALL </span><br><span class="line">tok = hanlp.load(hanlp.pretrained.tok.COARSE_ELECTRA_SMALL_ZH)</span><br><span class="line">res=tok(sentence)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure><br>å…¶å®æ›´å¤šæ–‡æ¡£åœ¨(è¿™ä¸ªé“¾æ¥)[<a href="https://github.com/hankcs/HanLP/tree/doc-zh]é‡Œæœ‰ï¼Œè¿™æ˜¯ååˆ†å¼ºå¤§çš„å·¥å…·ï¼Œå¹¶ä¸”å·²ç»å•†ä¸šåŒ–ã€‚">https://github.com/hankcs/HanLP/tree/doc-zh]é‡Œæœ‰ï¼Œè¿™æ˜¯ååˆ†å¼ºå¤§çš„å·¥å…·ï¼Œå¹¶ä¸”å·²ç»å•†ä¸šåŒ–ã€‚</a></p><p>python3.8ä»¥ä¸‹ä½¿ç”¨<a href="https://pypi.org/project/pyhanlp/">è¿™ä¸ª</a><br>æ ¹æ®å®˜æ–¹æ–‡æ¡£ä¸‹è½½ï¼Œ<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda install -c conda-forge openjdk python=3.8 jpype1=0.7.0 -y</span><br><span class="line">pip install pyhanlp</span><br></pre></td></tr></table></figure><br>åå¯ä»¥ä½¿ç”¨<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyhanlp <span class="keyword">import</span> *</span><br><span class="line">sentence=<span class="string">&#x27;æˆ‘è‰ä½ æ˜¯çœŸçš„ç‰›æ‰¹&#x27;</span></span><br><span class="line">res=HanLP.segment(sentence)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure></p><h1 id="paddlepaddle"><a href="#paddlepaddle" class="headerlink" title="paddlepaddle"></a>paddlepaddle</h1><p>paddlepaddleçš„hubé‡Œé¢æœ‰å¾ˆå¤šä¸­æ–‡åˆ†è¯æ¨¡å‹ï¼Œè§<a href="https://blog.csdn.net/qq_42067550/article/details/106026629">è¿™é‡Œ</a></p><p>å…¶å®è¿™æ ·çœ‹torchç¤¾åŒºå’Œtensorflowç¤¾åŒºä¹Ÿæœ‰å¾ˆå¤šhubçš„æ¨¡å‹å¯ä»¥ä½¿ç”¨ã€‚</p><h1 id="stanza"><a href="#stanza" class="headerlink" title="stanza"></a>stanza</h1><p>æ˜¯æ–¯å¦ç¦CoreNLPçš„ç»§æ‰¿ï¼Œå®‰è£…å’Œä½¿ç”¨ç›¸å¯¹éº»çƒ¦ï¼Œè§<a href="https://blog.csdn.net/shenliang1985/article/details/103509258">è¿™é‡Œ</a></p><h1 id="fenci"><a href="#fenci" class="headerlink" title="fenci"></a><a href="https://github.com/a358003542/fenci">fenci</a></h1><p>git cloneä¸‹å°±å¯ä»¥ä½¿ç”¨ï¼Œååˆ†è½»é‡çº§ï¼Œæ˜¯jiebaçš„å‡çº§ç‰ˆå’Œç»§æ‰¿é¡¹ç›®ã€‚<br><a href="https://github.com/fxsjy/jieba/issues/957">jiebaé¡¹ç›®â€œå·²æ­»â€</a><br>ä½†æ˜¯fenciåªèƒ½åˆ†è¯ï¼Œæ²¡æœ‰è¯æ€§æ ‡æ³¨ç­‰åŠŸèƒ½ã€‚</p><h1 id="pkuseg"><a href="#pkuseg" class="headerlink" title="pkuseg"></a><a href="https://github.com/lancopku/pkuseg-python#%E5%90%84%E7%B1%BB%E5%88%86%E8%AF%8D%E5%B7%A5%E5%85%B7%E5%8C%85%E7%9A%84%E6%80%A7%E8%83%BD%E5%AF%B9%E6%AF%94">pkuseg</a></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pkuseg</span><br></pre></td></tr></table></figure><p>åï¼Œå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼ˆç®€ç•¥ï¼‰<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Building wheels for collected packages: pkuseg</span><br><span class="line">  Building wheel for pkuseg (setup.py) ... error</span><br><span class="line">  error: subprocess-exited-with-error</span><br><span class="line">  </span><br><span class="line">  Ã— python setup.py bdist_wheel did not run successfully.</span><br><span class="line">  â”‚ exit code: 1</span><br><span class="line">  â•°â”€&gt; [208 lines of output]</span><br><span class="line">      /usr/share/anaconda3/envs/yzc_trans/lib/python3.9/site-packages/setuptools/installer.py:27: SetuptoolsDeprecationWarning: setuptools.installer is deprecated. Requirements should be satisfied by a PEP 517 installer.</span><br><span class="line">        warnings.warn(</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  note: This error originates from a subprocess, and is likely not a problem with pip.</span><br><span class="line">error: legacy-install-failure</span><br><span class="line"></span><br><span class="line">Ã— Encountered error while trying to install package.</span><br><span class="line">â•°â”€&gt; pkuseg</span><br><span class="line"></span><br><span class="line">note: This is an issue with the package mentioned above, not pip.</span><br><span class="line">hint: See above for output from the failure.</span><br></pre></td></tr></table></figure><br>åº”è¯¥æ˜¯è€äº†ï¼Œpipè¿˜è¯´è¿™æ˜¯packageè‡ªå·±çš„é—®é¢˜ï¼Œä¸æ˜¯pipçš„é—®é¢˜ã€‚é‚£åº”è¯¥æ˜¯æ˜¯å¤ªè€äº†ã€‚</p><h1 id="jieba"><a href="#jieba" class="headerlink" title="jieba"></a>jieba</h1><p>ä¸èµ˜è¿°ï¼Œå¤ªå¤šåšå®¢äº†ã€‚</p><h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><p>å¯ä»(è¿™é‡Œ)[<a href="https://github.com/ysc/cws_evaluation]çœ‹åˆ°å¦å¤–çš„åˆ†è¯å™¨">https://github.com/ysc/cws_evaluation]çœ‹åˆ°å¦å¤–çš„åˆ†è¯å™¨</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Cox PHæ¨¡å‹</title>
      <link href="/2022/09/18/cox%20PH/"/>
      <url>/2022/09/18/cox%20PH/</url>
      
        <content type="html"><![CDATA[<p>Cox PH model, å…¨ç§° proportional hazard regression model.</p><h1 id="æ¨¡å‹å‡è®¾å‰æ"><a href="#æ¨¡å‹å‡è®¾å‰æ" class="headerlink" title="æ¨¡å‹å‡è®¾å‰æ"></a>æ¨¡å‹å‡è®¾å‰æ</h1><p>PHï¼Œæ¯”ä¾‹é£é™©å˜é‡å¯¹ç”Ÿå­˜ç‡çš„å½±å“ä¸éšæ—¶é—´çš„æ”¹å˜è€Œæ”¹å˜ã€‚<br>ä¸¾ä¸ªä¾‹å­ï¼Œè‹¥ä»¥$h$é¢„æµ‹ç”Ÿå­˜æ¦‚ç‡ï¼Œåˆ™$h<em>{t_i}(x)$ä¸$h</em>{t_0}(x)$æ˜¯å®šå€¼ã€‚</p><h1 id="æ˜¯ä»€ä¹ˆ"><a href="#æ˜¯ä»€ä¹ˆ" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h1><p>å‡è®¾$h$æ˜¯ç”Ÿå­˜é¢„æµ‹æ¨¡å‹å‡½æ•°ï¼ˆè¾“å‡ºtæ—¶åˆ»ç”Ÿå­˜é£é™©ï¼‰ï¼Œåˆ™</p><script type="math/tex; mode=display">h(t,X)=h_0(t) * exp(\sum w_ix_i)</script><p>è¡¨ç¤ºç‰¹å¾æ˜¯$X$çš„äººåœ¨tæ—¶åˆ»çš„é£é™©ã€‚ä½†æ˜¯$h_0$æ˜¯ä¸éœ€è¦æ±‚çš„ï¼Œ$h_0$é™¤è¿‡å»ä¸¤è¾¹å–å¯¹æ•°</p><script type="math/tex; mode=display">ln\frac{h(t,X)}{h_0(t)}=\sum w_ix_i</script><p>å…¶å®ç®—æ˜¯ä¸€ä¸ªçº¿æ€§å›å½’ã€‚</p><h1 id="æ±‚è§£å‚æ•°"><a href="#æ±‚è§£å‚æ•°" class="headerlink" title="æ±‚è§£å‚æ•°"></a>æ±‚è§£å‚æ•°</h1><p>æå¤§ä¼¼ç„¶ä¼°è®¡<br>å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/538476448">https://zhuanlan.zhihu.com/p/538476448</a> </p><h1 id="Metrics"><a href="#Metrics" class="headerlink" title="Metrics"></a>Metrics</h1><h2 id="CI"><a href="#CI" class="headerlink" title="CI"></a><a href="https://www.semanticscholar.org/paper/Multivariable-prognostic-models%3A-issues-in-models%2C-Harrell-Lee/a6d33daa0e093a50b1b58e3aa34191c4b5acda92">CI</a></h2><p>C-indexæœ‰å¤šç§ï¼Œåªä»‹ç»é“¾æ¥é‚£ç§ã€‚</p><p>concordence index $\in [0.5,1]$, åœ¨éåˆ å¤±çš„æ•°æ®ä¸­ï¼Œä¸¤ä¸¤ç»„pairï¼Œ#è¡¨ç¤ºpairçš„ä¸ªæ•°ã€‚<script type="math/tex">CI=\frac{\# expectated\ pair}{\# all\ pair}</script>.</p><p>ç»“åˆåˆ å¤±æ ‡å¿—ä½$\delta$çš„è¯ï¼Œ<br>Given observed survival times ti, predicted risk scores Î·i, and<br>censoring indicators Î´i, the concordance index is defined as<br>å¯ä»¥è¡¨ç¤ºä¸º</p><script type="math/tex; mode=display">CI=\frac{\sum_j\sum_i 1_{t_j<t_i}1_{\eta_j>\eta_i}\delta}{\sum_j\sum_i 1_{t_j<t_i}\delta}</script><p>Î´i is the censoring indicator: Î´i = 0 if the survival time of the i-th patient was censored, and Î´i = 1 otherwise. 0 unuseful 1 useful.</p><p>æ‰€ä»¥å¯è§ï¼Œå…¶æ²¡æœ‰ä½¿ç”¨åˆ å¤±æ•°æ®ã€‚<br>ä¸¾ä¸ªä¾‹å­supposeï¼š<br>| survival time      | predict rish | censored|CI|<br>| â€”â€”â€”â€”â€”- | â€”â€”â€”â€”â€”- |â€”â€”â€”â€”â€”- | â€”â€”â€”â€”â€”- |<br>| 4      | 0.9       |0<br>| 5   | 0.8        |1<br>| 6   | 0.7        |0</p><p>åˆ™<script type="math/tex">CI=</script></p><h2 id="REA"><a href="#REA" class="headerlink" title="REA"></a><a href="https://dl.acm.org/doi/10.5555/2986459.2986665">REA</a></h2><p>Relative absolute error,</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Dynamic Planning Series</title>
      <link href="/2022/09/02/dp/"/>
      <url>/2022/09/02/dp/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸Šå°é˜¶-å…¥é—¨"><a href="#ä¸Šå°é˜¶-å…¥é—¨" class="headerlink" title="ä¸Šå°é˜¶(å…¥é—¨)"></a>ä¸Šå°é˜¶(å…¥é—¨)</h1><h1 id="çŸ©é˜µè·¯å¾„ç›¸å…³"><a href="#çŸ©é˜µè·¯å¾„ç›¸å…³" class="headerlink" title="çŸ©é˜µè·¯å¾„ç›¸å…³"></a>çŸ©é˜µè·¯å¾„ç›¸å…³</h1><h2 id="desc"><a href="#desc" class="headerlink" title="desc"></a>desc</h2><p><a href="https://leetcode.cn/problems/unique-paths/">ä¸åŒè·¯å¾„</a><br><a href="https://leetcode.cn/problems/unique-paths-ii/">ä¸åŒè·¯å¾„2</a><br><a href="https://leetcode.cn/problems/minimum-path-sum/">æœ€å°è·¯å¾„</a><br><a href="https://leetcode.cn/problems/dungeon-game/">åœ°ä¸‹åŸ</a></p><h2 id="idea"><a href="#idea" class="headerlink" title="idea"></a>idea</h2><p>é¢˜ç›®ä»¥çŸ©é˜µçš„å½¢å¼ç»™å‡ºæ¥.<br>å®šä¹‰$dp[i][j]$æ˜¯åˆ°è¾¾i jçš„æœ€ä¼˜è§£ï¼Œé‚£ä¹ˆ$dp[i][j]$å¾€å¾€åªèƒ½æ¥è‡ª$dp[i-1][j]$å’Œ$dp[i][j-1]$ï¼Œå¯ä»¥æ ¹æ®è¦æ±‚å†™å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚<br><strong>å¹¶ä¸éƒ½æ˜¯æ‰€æœ‰çŸ©é˜µå½¢å¼éƒ½æ˜¯è¿™ç§åŠ¨æ€è§„åˆ’ã€‚</strong></p><h1 id="åºåˆ—ç›¸å…³"><a href="#åºåˆ—ç›¸å…³" class="headerlink" title="åºåˆ—ç›¸å…³"></a>åºåˆ—ç›¸å…³</h1><p>æç¤ºï¼šå¹¶ä¸æ˜¯æ‰€æœ‰å­—ç¬¦ä¸²é—®é¢˜éƒ½æ˜¯ç”¨dpæ±‚è§£ï¼Œèƒ½æš´åŠ›çš„å¯ä»¥å…ˆæš´åŠ›ä¸€ä¸‹çœ‹çœ‹ã€‚</p><h2 id="æœ€é•¿è¿ç»­é€’å¢åºåˆ—"><a href="#æœ€é•¿è¿ç»­é€’å¢åºåˆ—" class="headerlink" title="æœ€é•¿è¿ç»­é€’å¢åºåˆ—"></a><a href="https://leetcode.cn/problems/longest-continuous-increasing-subsequence/">æœ€é•¿è¿ç»­é€’å¢åºåˆ—</a></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">findLengthOfLCIS</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="comment"># dp[i]æ˜¯ä»¥nums[i]ä¸ºæœ€åä¸€ä¸ªå…ƒç´ çš„æœ€é•¿é•¿åº¦</span></span><br><span class="line">        dp=[<span class="number">0</span> <span class="keyword">for</span> n <span class="keyword">in</span> nums]</span><br><span class="line">        dp[<span class="number">0</span>]=<span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(nums)):</span><br><span class="line">            <span class="keyword">if</span> nums[i]&gt;nums[i-<span class="number">1</span>]:</span><br><span class="line">                dp[i]=dp[i-<span class="number">1</span>]+<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dp[i]=<span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(dp)</span><br></pre></td></tr></table></figure><h2 id="æœ€é•¿é€’å¢å­åºåˆ—"><a href="#æœ€é•¿é€’å¢å­åºåˆ—" class="headerlink" title="æœ€é•¿é€’å¢å­åºåˆ—"></a><a href="https://leetcode.cn/problems/longest-increasing-subsequence/">æœ€é•¿é€’å¢å­åºåˆ—</a></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">lengthOfLIS</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        length=<span class="built_in">len</span>(nums)</span><br><span class="line">        dp=[<span class="number">1</span> <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(length)]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">            <span class="comment"># ä»å‰é¢iä¸ªé‡Œé¢æ‰¾æ¯”nums[i]å¤§çš„</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> nums[i]&gt;nums[j]:</span><br><span class="line">                    <span class="comment"># å¯ä»¥æ¥çš„å¾ˆå¤šï¼Œæˆ‘è¦æ‰¾ä¸€ä¸ªæœ€å¤§çš„æ¥è¿›å»</span></span><br><span class="line">                    dp[i]=<span class="built_in">max</span>(dp[i],dp[j]+<span class="number">1</span>)</span><br><span class="line">                </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(dp)</span><br></pre></td></tr></table></figure><p><a href="https://leetcode.cn/problems/increasing-triplet-subsequence/">æ£€æŸ¥æ¸¸æˆ1</a><br><a href="https://leetcode.cn/problems/number-of-longest-increasing-subsequence/">æ£€æŸ¥æ¸¸æˆ2</a></p><h2 id="æœ€å¤§å­åºåˆ—å’Œ"><a href="#æœ€å¤§å­åºåˆ—å’Œ" class="headerlink" title="æœ€å¤§å­åºåˆ—å’Œ"></a><a href="https://leetcode.cn/problems/lian-xu-zi-shu-zu-de-zui-da-he-lcof/">æœ€å¤§å­åºåˆ—å’Œ</a></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">maxSubArray</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="comment"># dp[i]ä»¥nums[i]ä¸ºç»“å°¾çš„æœ€å¤§è¿ç»­å’Œ</span></span><br><span class="line">        length=<span class="built_in">len</span>(nums)</span><br><span class="line">        dp=[n <span class="keyword">for</span> n <span class="keyword">in</span> nums]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,length):    </span><br><span class="line">            <span class="comment"># æ˜¯è‡ªå·±ç‹¬ç«‹ï¼Œè¿˜æ˜¯å¹¶å…¥å‰é¢ï¼Ÿ</span></span><br><span class="line">            dp[i]=<span class="built_in">max</span>(dp[i-<span class="number">1</span>]+nums[i],dp[i])</span><br><span class="line">        <span class="comment"># å¯ä»¥ä¸éœ€è¦dpæ•°ç»„ç›´æ¥ç”¨resã€‚ä½†æ˜¯çœ‹èµ·æ¥æ–¹ä¾¿è¿˜æ˜¯ä¿ç•™</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(dp)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æœ€é•¿å…¬å…±å­åºåˆ—-Longest-Common-Sub-string-LCS"><a href="#æœ€é•¿å…¬å…±å­åºåˆ—-Longest-Common-Sub-string-LCS" class="headerlink" title="æœ€é•¿å…¬å…±å­åºåˆ— Longest Common Sub-string(LCS)"></a><a href="https://leetcode.cn/problems/qJnOS7/">æœ€é•¿å…¬å…±å­åºåˆ— Longest Common Sub-string(LCS)</a></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">longestCommonSubsequence</span>(<span class="params">self, text1: <span class="built_in">str</span>, text2: <span class="built_in">str</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        len1=<span class="built_in">len</span>(text1)</span><br><span class="line">        len2=<span class="built_in">len</span>(text2)</span><br><span class="line">        <span class="comment"># dp[i][j]è¡¨ç¤ºAä¸²åˆ°iä¸”Bä¸²åˆ°jæ—¶å€™ï¼Œæœ€é•¿å…¬å…±å­åºåˆ—ã€‚å¤šå‡ºæ¥0 0ï¼Œæ–¹ä¾¿åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line">        dp=[[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(len2+<span class="number">1</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(len1+<span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,len1+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,len2+<span class="number">1</span>):</span><br><span class="line">                <span class="comment"># å½“å‰çš„ijä¸åŸå­—ç¬¦ä¸²çš„i jæœ‰åç§»ã€‚</span></span><br><span class="line">                <span class="keyword">if</span> text1[i-<span class="number">1</span>]==text2[j-<span class="number">1</span>]:</span><br><span class="line">                    <span class="comment"># è‹¥ç›¸åŒ</span></span><br><span class="line">                    dp[i][j]=dp[i-<span class="number">1</span>][j-<span class="number">1</span>]+<span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="comment"># è‹¥ä¸ç›¸åŒï¼Œ</span></span><br><span class="line">                    dp[i][j]=<span class="built_in">max</span>(dp[i-<span class="number">1</span>][j],dp[i][j-<span class="number">1</span>])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> dp[-<span class="number">1</span>][-<span class="number">1</span>]</span><br></pre></td></tr></table></figure><h2 id="æ‰“å®¶åŠ«èˆï¼ˆæ ‘å½¢dpï¼‰"><a href="#æ‰“å®¶åŠ«èˆï¼ˆæ ‘å½¢dpï¼‰" class="headerlink" title="æ‰“å®¶åŠ«èˆï¼ˆæ ‘å½¢dpï¼‰"></a><a href="https://leetcode.cn/problems/house-robber/">æ‰“å®¶åŠ«èˆï¼ˆæ ‘å½¢dpï¼‰</a></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rob</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(nums)==<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> nums[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(nums)==<span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">max</span>(nums[<span class="number">0</span>],nums[<span class="number">1</span>])</span><br><span class="line">        <span class="comment"># dpè¡¨ç¤ºæ­¤ä½ç½®çš„æœ€å¤§å€¼</span></span><br><span class="line">        dp=[<span class="number">0</span> <span class="keyword">for</span> n <span class="keyword">in</span> nums]</span><br><span class="line">        dp[<span class="number">0</span>]=nums[<span class="number">0</span>]</span><br><span class="line">        dp[<span class="number">1</span>]=<span class="built_in">max</span>(nums[<span class="number">0</span>],nums[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        length=<span class="built_in">len</span>(nums)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,length):</span><br><span class="line">            dp[i]=<span class="built_in">max</span>(dp[i-<span class="number">1</span>],dp[i-<span class="number">2</span>]+nums[i])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> dp[-<span class="number">1</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><a href="https://leetcode.cn/problems/house-robber-ii/">æ‰“å®¶åŠ«èˆ2</a>:ä¸‹æ ‡èŒƒå›´dpï¼Œåæ¯”è¾ƒå³å¯<br><a href="https://leetcode.cn/problems/house-robber-iii/">æ‰“å®¶åŠ«èˆ3</a></p><h1 id="èƒŒåŒ…"><a href="#èƒŒåŒ…" class="headerlink" title="èƒŒåŒ…"></a>èƒŒåŒ…</h1><p><a href="https://www.bilibili.com/video/BV1X741127ZM">é—«æ°dpåˆ†ææ³•æ•™ç¨‹</a></p><h2 id="01èƒŒåŒ…"><a href="#01èƒŒåŒ…" class="headerlink" title="01èƒŒåŒ…"></a>01èƒŒåŒ…</h2><p>å…¶ä¸­cap = capacityï¼Œè¡¨ç¤ºèƒŒåŒ…å®¹é‡ï¼Œnè¡¨ç¤ºç‰©å“ä¸ªæ•°ã€‚<br>å®šä¹‰dpæ•°ç»„æ˜¯èƒŒåŒ…å®¹é‡ä¸ºWï¼Œä¸”è¿­ä»£åˆ°ç¬¬iä¸ªç‰©å“æ—¶èƒ½æ‹¿åˆ°çš„æœ€å¤§ä»·å€¼æ•°ã€‚</p><p>ç”±äºéœ€è¦å…ˆåˆå§‹åŒ–dp[0][j]å’Œdp[i][0]ï¼Œåˆ™dpæ•°ç»„éœ€è¦å¤šå‡ºä¸€è¡Œä¸€åˆ—ï¼Œæ³¨æ„weightså’Œvaluesæ•°æ®ä¼šä¸‹æ ‡åç§»ã€‚<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">n,cap=[<span class="built_in">int</span>(n) <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">input</span>().strip().split()] </span><br><span class="line"><span class="comment"># cap = capacity</span></span><br><span class="line">dp=[[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(cap+<span class="number">1</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n+<span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line">values,weights=[],[]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    w,v=[<span class="built_in">int</span>(n) <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">input</span>().strip().split()]</span><br><span class="line">    values.append(v)</span><br><span class="line">    weights.append(w)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> cap_now <span class="keyword">in</span> <span class="built_in">range</span>(cap+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> cap_now&gt;=weights[i-<span class="number">1</span>]:</span><br><span class="line">            <span class="comment"># å¦‚æœèƒ½æ‹¿ï¼Œä½†æ˜¯æˆ‘å¯ä»¥é€‰æ‹©ä¸æ‹¿</span></span><br><span class="line">            dp[i][cap_now]=<span class="built_in">max</span>(dp[i-<span class="number">1</span>][cap_now],dp[i-<span class="number">1</span>][cap_now-weights[i-<span class="number">1</span>]]+values[i-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># æ­¤æ—¶è‚¯å®šæ‹¿ä¸äº†</span></span><br><span class="line">            dp[i][cap_now]=dp[i-<span class="number">1</span>][cap_now]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dp[-<span class="number">1</span>][-<span class="number">1</span>])</span><br></pre></td></tr></table></figure><br>ç”±äºå¯ä»¥ä¼˜åŒ–ä¸‹ç©ºé—´å’Œå†™æ³•ï¼Œæ‰€ä»¥å¯ä»¥ï¼š<br>æ³¨æ„å€’åºçš„weightså’Œä¸‹æ ‡å¼€å§‹ç‚¹<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cap = capacity</span></span><br><span class="line">dp=[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(cap+<span class="number">1</span>)] </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> cap_now <span class="keyword">in</span> <span class="built_in">range</span>(cap+<span class="number">1</span>)[::-<span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">if</span> cap_now&gt;=weights[i-<span class="number">1</span>]:</span><br><span class="line">            <span class="comment"># å¦‚æœèƒ½æ‹¿ï¼Œä½†æ˜¯æˆ‘å¯ä»¥é€‰æ‹©ä¸æ‹¿</span></span><br><span class="line">            dp[cap_now]=<span class="built_in">max</span>(dp[cap_now],dp[cap_now-weights[i-<span class="number">1</span>]]+values[i-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            dp[cap_now]=dp[cap_now]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dp[-<span class="number">1</span>])</span><br></pre></td></tr></table></figure><br>ä¸ºä»€ä¹ˆä¸æ”¹æ‰<code>if else</code>è¯­å¥ï¼Ÿå› ä¸ºæ–¹ä¾¿è®°å¿†ã€‚</p><h2 id="å®Œå…¨èƒŒåŒ…"><a href="#å®Œå…¨èƒŒåŒ…" class="headerlink" title="å®Œå…¨èƒŒåŒ…"></a>å®Œå…¨èƒŒåŒ…</h2><p>tbd</p>]]></content>
      
      
      
        <tags>
            
            <tag> classic algorithm, data structure </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Learning Backward Compatible Embeddings</title>
      <link href="/2022/09/02/kdd2022%20%20Compatible%20Embeddings/"/>
      <url>/2022/09/02/kdd2022%20%20Compatible%20Embeddings/</url>
      
        <content type="html"><![CDATA[<h1 id="æ–‡ç« é“¾æ¥"><a href="#æ–‡ç« é“¾æ¥" class="headerlink" title="æ–‡ç« é“¾æ¥"></a>æ–‡ç« é“¾æ¥</h1><p>KDD2022ï¼š <a href="https://cs.stanford.edu/people/jure/pubs/bcemb-kdd22.pdf">https://cs.stanford.edu/people/jure/pubs/bcemb-kdd22.pdf</a></p><h1 id="æ–‡ç« ä¸»è¦å†…å®¹"><a href="#æ–‡ç« ä¸»è¦å†…å®¹" class="headerlink" title="æ–‡ç« ä¸»è¦å†…å®¹"></a>æ–‡ç« ä¸»è¦å†…å®¹</h1><p>æ–‡ç« æœ¬èº«è¯´çš„æƒ…æ™¯å¹¶ä¸é€‚åˆã€‚<br>ä¸ªäººè®¤ä¸ºæ­¤æ–¹æ³•é€‚åˆçš„åœºæ™¯æ˜¯ï¼šå¦‚ä½•åœ¨ä½å‚¨å­˜é‡çš„å‰æä¸‹äº¤ä»˜å¤šä¸ªä¸‹æ¸¸ç”¨æˆ·ã€‚è€Œä¸æ˜¯æ–‡ç« è¯´çš„åœ¨åŒä¸€ä¸ªæ¨¡å‹ä¸æ–­è¿­ä»£çš„æƒ…æ™¯ä¸‹ä¿æŒå¯¹æŸä¸ªç”¨æˆ·çš„ç¨³å®šèŠ‚ç‚¹è¡¨ç¤ºã€‚</p><h1 id="æ–‡ç« ä¸»è¦æ–°æ„"><a href="#æ–‡ç« ä¸»è¦æ–°æ„" class="headerlink" title="æ–‡ç« ä¸»è¦æ–°æ„"></a>æ–‡ç« ä¸»è¦æ–°æ„</h1><p>æŠŠåŸå…ˆåªåœ¨face recognitionçš„æ–¹æ³•è¿ç§»åˆ°å›¾è¡¨ç¤ºä¸Šæ¥ã€‚å¦å¤–è¿˜åšäº†äº›å·¥ç¨‹ä¸Šçš„å°è¯•ã€‚</p><h1 id="æ–‡ç« è„‰ç»œ"><a href="#æ–‡ç« è„‰ç»œ" class="headerlink" title="æ–‡ç« è„‰ç»œ"></a>æ–‡ç« è„‰ç»œ</h1><h2 id="3ç§åº”å¯¹åœºæ™¯çš„æ–¹æ³•"><a href="#3ç§åº”å¯¹åœºæ™¯çš„æ–¹æ³•" class="headerlink" title="3ç§åº”å¯¹åœºæ™¯çš„æ–¹æ³•"></a>3ç§åº”å¯¹åœºæ™¯çš„æ–¹æ³•</h2><ul><li>keep allï¼ŒæŠŠæ‰€æœ‰ä½¿ç”¨åˆ°çš„embeddingéƒ½å­˜å‚¨</li><li>keep latestï¼Œåªå­˜å‚¨æœ€åä¸€ç‰ˆemebddingï¼Œå‰©ä¸‹çš„ç”¨Bæ¥è½¬æ¢åˆ°å¯¹åº”ç‰ˆæœ¬ï¼Œæ–‡ç« åœ¨è¿™ä¸€æ–¹æ³•ä¸‹åšäº†6ç§ä¸åŒçš„å®éªŒã€‚</li><li>keep originalï¼Œ åªå‚¨å­˜ç¬¬ä¸€ç‰ˆembeddingï¼Œä½†æ˜¯æ–‡ç« é™¤äº†ç”¨fine tuneï¼Œå¹¶æ²¡æœ‰ç»™å‡ºæ›´å¤šå®éªŒã€‚<h2 id="3ç§å®éªŒsettingï¼š"><a href="#3ç§å®éªŒsettingï¼š" class="headerlink" title="3ç§å®éªŒsettingï¼š"></a>3ç§å®éªŒsettingï¼š</h2>ä¸ºäº†å­¦åˆ°ä¸€ä¸ªBçŸ©é˜µï¼Œç”¨æ¥è¿˜åŸä¸Šä¸€ç‰ˆï¼Œ</li><li>Representation transformationï¼šå¯¹ä¸Šä¸€æ­¥çš„embeddingæ˜¯å¦åšlinearå˜æ¢ï¼Œåšlinearçš„æ–‡ç« å«<code>Lin</code>ï¼Œä¸åšçš„å«<code>Notrans</code></li><li>Single/Multiple version of Regularizerï¼šåªå¯¹ä¸Šä¸€æ­¥çš„embeddingåšæ‹‰è¿‘è¿˜æ˜¯å¯¹å‰å¤šæ­¥çš„embeddingåšæ‹‰è¿‘ã€‚ä¸Šä¸€æ­¥çš„æ–‡ç« å«<code>Single step</code>ï¼Œä¸Šå¤šæ­¥çš„å«<code>Multi step</code></li><li>Training: å…ˆtrainå†regularizeï¼Œè¿˜æ˜¯trainingä¸regularizationä¸€èµ·ã€‚å…ˆtrainå†regularizeå«<code>Posthoc</code>ï¼Œä¸€èµ·çš„å«<code>Joint</code>ã€‚</li></ul><p>åŸæœ¬åº”è¯¥æœ‰2<em>2</em>2 å…±8ç§å®éªŒï¼Œä½†æ˜¯æ–‡ç« åªç»™å‡ºäº†6ç§ã€‚</p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>æ¨¡å‹ä½¿ç”¨Pinsageï¼Œä¹Ÿå°±æ˜¯graph sageã€‚</p><h1 id="å…¶ä»–ï¼š-æƒ…æ™¯ç†ç”±"><a href="#å…¶ä»–ï¼š-æƒ…æ™¯ç†ç”±" class="headerlink" title="å…¶ä»–ï¼š æƒ…æ™¯ç†ç”±"></a>å…¶ä»–ï¼š æƒ…æ™¯ç†ç”±</h1><p>ä¸ºäº†â€œç¨³å®šèŠ‚ç‚¹è¡¨ç¤ºâ€è€Œå»å€’æ¨å›åŸå…ˆçš„ä¸€å¥—è¡¨ç¤ºï¼Ÿé‚£æˆ‘æ–°è®­ç»ƒå‡ºæ¥çš„æ–°çš„embeddingæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p>]]></content>
      
      
      
        <tags>
            
            <tag> paper reading, analysis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>metric-learning</title>
      <link href="/2022/09/01/metric_learning/"/>
      <url>/2022/09/01/metric_learning/</url>
      
        <content type="html"><![CDATA[<h1 id="Euclidean-distance-L2-norm"><a href="#Euclidean-distance-L2-norm" class="headerlink" title="Euclidean distance (L2 norm)"></a>Euclidean distance (L2 norm)</h1><p>No explanation, too simple.</p><p>eg: 2-demensional data</p><script type="math/tex; mode=display">A=(a_1,a_2)\ B=(b_1,b_2)</script><script type="math/tex; mode=display">D(A,B)=\sqrt{(a_1âˆ’b_1)^2+(a_2âˆ’b_2)^2}</script><h1 id="Mahalanobis-distance"><a href="#Mahalanobis-distance" class="headerlink" title="Mahalanobis distance"></a>Mahalanobis distance</h1><p>A distance with consideration on data distribution, more specifically on covarience and demention(é‡çº²). Euclidean is Mahalanobis distance if you perform PCA and normalization on data. In other word, Euclidean distance is a special case of Mahalanobis distance.</p><script type="math/tex; mode=display">D(x,y)=\sqrt{(xâˆ’y)^TÎ£^{âˆ’1}(xâˆ’y)}</script><p>where Î£ is the covariance metrix of the two data.</p><h1 id="contrastive-loss-å¯¹æ¯”æŸå¤±"><a href="#contrastive-loss-å¯¹æ¯”æŸå¤±" class="headerlink" title="contrastive loss(å¯¹æ¯”æŸå¤±)"></a>contrastive loss(å¯¹æ¯”æŸå¤±)</h1><p>Itâ€™s created with the idea that we should pull as far as possible away for any data that do not belong to the same class and pull as close as possible for ones that belong to the same class.</p><script type="math/tex; mode=display">D(X_i,X_j)=y_{i,j}d^2_{i,j}+(1âˆ’y_{i,j})[Î±âˆ’d^2_{i,j}]</script><p>where $y<em>{i,j}$ is 1 if $X_i$ and $X_j$ is of same class, and 0 otherwise, $d</em>{i,j}$ is euclidean distance, and $Î±$ controls how aggressive you want different classes to be.</p><p>It can measure data that has never shown before, which cannot be done by classic methods.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>YOLOv5 ç»“æœè§£æ</title>
      <link href="/2020/09/16/yolov5_res/"/>
      <url>/2020/09/16/yolov5_res/</url>
      
        <content type="html"><![CDATA[<h1 id="Confusion-matrix"><a href="#Confusion-matrix" class="headerlink" title="Confusion matrix"></a>Confusion matrix</h1><p>ä»¥è¿™ç§å½¢å¼ç»™å‡ºçŸ©é˜µçš„å€¼</p><div class="table-container"><table><thead><tr><th></th><th>$gt_{class1}$</th><th>$gt_{class2}$</th><th>$gt_{class3}$</th><th>background FP</th></tr></thead><tbody><tr><td>$pred_{class1}$</td></tr><tr><td>$pred_{class2}$     </td></tr><tr><td>$pred_{class3}$</td></tr><tr><td>background FN</td></tr></tbody></table></div><p><img src="https://img-blog.csdnimg.cn/36f1d7598d4141c3a6c9c0eed111df08.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">è‹¥æ˜¯åˆ†ç±»çš„å®Œç¾ï¼Œåˆ™åº”å½“åªæœ‰å¯¹è§’çº¿æ˜¯é«˜å³°ï¼Œå…¶ä½™éƒ½æ˜¯0ï¼ˆé™¤äº†æœ€åä¸€è¡Œå’Œæœ€åä¸€åˆ—ï¼‰.<br>æ ¹æ®GitHubä¸Šçš„è®¨è®ºï¼Œbackgroundä¹Ÿè¢«åˆ—æˆå•ç‹¬ä¸€ç±»ï¼Œæ‰€ä»¥ä¹Ÿæœ‰ä»–çš„TPã€FPã€TNã€FNç­‰ã€‚</p><p><strong>æœ€åä¸€åˆ—å’Œæœ€åä¸€è¡Œéƒ½æ˜¯ä»¥backgroundçš„ç±»åˆ«posçš„predictionçš„FNå’ŒFP</strong>ã€‚æ‰€ä»¥æœ€å³ä¸‹è§’æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œæ²¡æœ‰å€¼ã€‚</p><ul><li>ç”±äºæœ€åä¸€åˆ—æ˜¯backgroundçš„FPï¼Œæœ¬æ¥ä¸æ˜¯èƒŒæ™¯çš„ï¼Œè¢«predåˆ†æˆäº†èƒŒæ™¯ï¼Œ<strong>æ¼æ£€äº†éèƒŒæ™¯ç‰©ä½“</strong></li><li>ç”±äºæœ€åä¸€è¡Œæ˜¯backgroundçš„FNï¼Œæœ¬æ¥æ˜¯èƒŒæ™¯çš„ï¼Œè¢«predåˆ†æˆäº†ä¸æ˜¯èƒŒæ™¯ï¼Œ<strong>è™šæ£€äº†æœ¬æ¥æ²¡æœ‰çš„ç‰©ä½“</strong>ã€‚</li></ul><blockquote><p>æ··æ·†çŸ©é˜µæœ€åä¸€è¡Œå’Œä¸€åˆ—æ˜¯èƒŒæ™¯ç±»ã€‚ä¸Šé¢æˆ‘ä»¬çŸ¥é“åˆ—æ˜¯æ¨¡å‹é¢„æµ‹çš„ç»“æœï¼Œè¡Œæ˜¯æ ‡ç­¾çš„çœŸå®ç»“æœã€‚è€ŒFPåˆ™æ˜¯è¡¨ç¤ºçœŸå®ä¸ºå‡é¢„æµ‹ä¸ºçœŸï¼ŒFNè¡¨ç¤ºçœŸå®ä¸ºçœŸé¢„æµ‹ä¸ºå‡ã€‚å¯ä»¥çœ‹åˆ°æœ€åä¸€è¡Œå³backgroundFNå‡ºç°æ•°å€¼ï¼Œè¡¨ç¤ºå‡ºç°äº†æ¼æ£€ï¼›æœ€åä¸€åˆ—å³background FPå‡ºç°æ•°å€¼ï¼Œåˆ™è¡¨ç¤ºå‡ºç°äº†è™šæ£€<br>æ¥è‡ª <a href="https://blog.csdn.net/m0_66447617/article/details/124180032">https://blog.csdn.net/m0_66447617/article/details/124180032</a>, </p><p>å¦å¤–å¯å‚è€ƒgithubä¸Šçš„è®¨è®ºï¼Œbackgroundä¹Ÿè¢«å•ç‹¬åˆ’åˆ†æˆäº†ä¸€ä¸ªç±»åˆ«ã€‚<br>    <a href="https://github.com/kaanakan/object_detection_confusion_matrix/issues/12">https://github.com/kaanakan/object_detection_confusion_matrix/issues/12</a></p></blockquote><p>ä»¥ä¸Šé¢çš„å›¾ä¸ºä¾‹å­çš„è¯ï¼Œå¯ä»¥çœ‹åˆ°background FNå„ç±»éƒ½æ¯”è¾ƒé«˜ï¼Œè™šæ£€äº†å¾ˆå¤šç‰©ä½“ï¼›background FP- hatçš„ç›¸å¯¹è¾ƒé«˜ï¼Œæ¼æ£€äº†å¾ˆå¤šheadç±»åˆ«çš„ç‰©ä½“ã€‚è€Œåœ¨éèƒŒæ™¯çš„ç±»åˆ«ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å¯¹è§’çº¿çš„å€¼ç›¸å¯¹å¤§ï¼Œå¯è§æ¨¡å‹èƒ½å¤Ÿå¾ˆå¥½çš„åˆ†æ¸…æ¥šè¿™ä¸‰ç±»è°æ˜¯è°ã€‚</p><h1 id="F1-curve"><a href="#F1-curve" class="headerlink" title="F1 curve"></a>F1 curve</h1><p><img src="https://img-blog.csdnimg.cn/48fdfad93ac2402599e7f189fd090c85.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æ¨ªåæ ‡æ˜¯ç½®ä¿¡é˜ˆå€¼ã€‚</p><script type="math/tex; mode=display">F1=2*\frac1{\frac1{precision}+\frac1{recall}}</script><p>æ­¤å›¾èƒ½å¤Ÿçœ‹åˆ°ä»€ä¹ˆé˜ˆå€¼ä¸‹ä»€ä¹ˆç±»åˆ«èƒ½å¤Ÿè¾¾åˆ°æœ€å¥½çš„F1 scoreï¼Œæ¯”å¦‚ç»¿çº¿åœ¨0.27å·¦å³ï¼Œæµ·è“è‰²åœ¨0.8å·¦å³ã€‚</p><h1 id="labels"><a href="#labels" class="headerlink" title="labels"></a>labels</h1><p><img src="https://img-blog.csdnimg.cn/c36f8eac520d47978e91ed1374c06841.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»™æ‰€æä¾›çš„labelæ•°æ®è¿›è¡Œç»Ÿè®¡ï¼Œæ˜¯4ä¸ªå›¾ï¼Œå·¦ä¸Šæ˜¯å„ä¸ªç‰©ä½“çš„æ•°é‡ç›´æ–¹å›¾ï¼Œå³ä¸Šæ˜¯ä¸­å¿ƒå¯¹é½åå„ä¸ªç‰©ä½“çš„bounding boxï¼Œå·¦ä¸‹è§’æ˜¯ä¸­å¿ƒç‚¹ç»Ÿè®¡ï¼Œå³ä¸‹è§’æ˜¯æ–¹æ¡†é•¿ã€å®½ç»Ÿè®¡</p><h1 id="results"><a href="#results" class="headerlink" title="results"></a>results</h1><p><img src="https://img-blog.csdnimg.cn/788a6a6fc6d947adbbf72974414ee040.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æ¨ªåæ ‡æ˜¯epochï¼Œæ ‡é¢˜æ¯”è¾ƒç›´è§‚çš„è¯´äº†æ¯ä¸ªå›¾çš„æ„æ€</p><h1 id="å‰©ä¸‹ä¸€äº›ä¸éœ€è¦è§£é‡Šçš„å›¾"><a href="#å‰©ä¸‹ä¸€äº›ä¸éœ€è¦è§£é‡Šçš„å›¾" class="headerlink" title="å‰©ä¸‹ä¸€äº›ä¸éœ€è¦è§£é‡Šçš„å›¾"></a>å‰©ä¸‹ä¸€äº›ä¸éœ€è¦è§£é‡Šçš„å›¾</h1><h2 id="å¸¸è§„æ›²çº¿"><a href="#å¸¸è§„æ›²çº¿" class="headerlink" title="å¸¸è§„æ›²çº¿"></a>å¸¸è§„æ›²çº¿</h2><p>P-R curve<br>P curve<br>R curve</p><h2 id="batchæŠ½å–çš„case-study"><a href="#batchæŠ½å–çš„case-study" class="headerlink" title="batchæŠ½å–çš„case study"></a>batchæŠ½å–çš„case study</h2><p><img src="https://img-blog.csdnimg.cn/985feb0454444956801d04e8798c5dd8.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™äº›å°±æ˜¯æŠ½å–ä¸ªä¾‹æŸ¥çœ‹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> cv, object detection </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Xgboost LightGBM Demo</title>
      <link href="/2020/09/06/xgboost/"/>
      <url>/2020/09/06/xgboost/</url>
      
        <content type="html"><![CDATA[<h1 id="Xgboost"><a href="#Xgboost" class="headerlink" title="Xgboost"></a>Xgboost</h1><h2 id="Binary-Classification"><a href="#Binary-Classification" class="headerlink" title="Binary Classification"></a>Binary Classification</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> StratifiedKFold</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_auc_score,precision_score</span><br><span class="line"><span class="keyword">import</span> xgboost <span class="keyword">as</span> xgb</span><br><span class="line"><span class="keyword">import</span> lightgbm <span class="keyword">as</span> lgb</span><br><span class="line"></span><br><span class="line">skfold=StratifiedKFold(n_splits=<span class="number">3</span>,random_state=<span class="number">2022</span>,shuffle=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> train_idx,val_idx <span class="keyword">in</span> skfold.split(all_data,labels):</span><br><span class="line">    <span class="comment"># xgbooståˆ’åˆ†æ•°æ®é›† è®­ç»ƒ</span></span><br><span class="line">    train_d=xgb.DMatrix(all_data[train_idx],labels[train_idx])</span><br><span class="line">    test_d=xgb.DMatrix(all_data[val_idx])</span><br><span class="line">    </span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">&#x27;booster&#x27;</span>:<span class="string">&#x27;gblinear&#x27;</span>, <span class="comment"># gbtree gblinear dart</span></span><br><span class="line">        <span class="string">&#x27;eta&#x27;</span>: <span class="number">0.1</span>,</span><br><span class="line">        <span class="comment"># &#x27;colsample_bytree&#x27;: 0.7,</span></span><br><span class="line">        <span class="comment"># &#x27;subsample&#x27;: 0.7,</span></span><br><span class="line">        <span class="comment"># &#x27;alpha&#x27;: 0.01, #L1 norm</span></span><br><span class="line">        <span class="comment"># &#x27;gamma&#x27;: 1,</span></span><br><span class="line">        <span class="string">&#x27;objective&#x27;</span>: <span class="string">&#x27;binary:logistic&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;seed&#x27;</span>: <span class="number">2022</span></span><br><span class="line">    &#125;</span><br><span class="line">    clf=xgb.train(params=params,evals=[(train_d,<span class="string">&#x27;Train&#x27;</span>)],dtrain=train_d,num_boost_round=<span class="number">10</span>) <span class="comment"># 0.65625</span></span><br><span class="line">    preds=clf.predict(test_d)</span><br><span class="line">    preds[preds &gt; <span class="number">0.5</span>] = <span class="number">0</span></span><br><span class="line">    preds[preds &lt;= <span class="number">0.5</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(preds)</span><br><span class="line">    <span class="comment"># precision 85 auc 60</span></span><br><span class="line"></span><br><span class="line">    test_y=labels[val_idx]</span><br><span class="line">    score=precision_score(test_y,preds)</span><br><span class="line">    <span class="built_in">print</span>(score)</span><br><span class="line">    score = roc_auc_score(test_y, preds)</span><br><span class="line">    <span class="built_in">print</span>(score, end=<span class="string">&#x27;\n\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    </span><br></pre></td></tr></table></figure><h2 id="Regression"><a href="#Regression" class="headerlink" title="Regression"></a>Regression</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> KFold</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_auc_score,mean_squared_error</span><br><span class="line"><span class="keyword">import</span> xgboost <span class="keyword">as</span> xgb</span><br><span class="line"><span class="keyword">import</span> lightgbm <span class="keyword">as</span> lgb</span><br><span class="line"></span><br><span class="line">skfold=KFold(n_splits=<span class="number">3</span>,random_state=<span class="number">2022</span>,shuffle=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> train_idx,val_idx <span class="keyword">in</span> skfold.split(all_data, labels):</span><br><span class="line">    <span class="comment"># xgbooståˆ’åˆ†æ•°æ®é›† è®­ç»ƒ</span></span><br><span class="line">    train_d=xgb.DMatrix(all_data[train_idx],labels[train_idx])</span><br><span class="line">    test_d=xgb.DMatrix(all_data[val_idx])</span><br><span class="line">    </span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">&#x27;booster&#x27;</span>:<span class="string">&#x27;gblinear&#x27;</span>, <span class="comment"># gbtree gblinear dart</span></span><br><span class="line">        <span class="string">&#x27;eta&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="comment"># &#x27;colsample_bytree&#x27;: 0.7,</span></span><br><span class="line">        <span class="comment"># &#x27;subsample&#x27;: 0.7,</span></span><br><span class="line">        <span class="string">&#x27;alpha&#x27;</span>: <span class="number">0.01</span>, <span class="comment">#L1 norm</span></span><br><span class="line">        <span class="comment"># &#x27;gamma&#x27;: 1,</span></span><br><span class="line">        <span class="string">&#x27;objective&#x27;</span>: <span class="string">&#x27;reg:squarederror&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;seed&#x27;</span>: <span class="number">2022</span></span><br><span class="line">    &#125;</span><br><span class="line">    clf=xgb.train(params=params,evals=[(train_d,<span class="string">&#x27;Train&#x27;</span>)],dtrain=train_d,num_boost_round=<span class="number">30</span>) <span class="comment"># 0.65625</span></span><br><span class="line">    preds=clf.predict(test_d)</span><br><span class="line"></span><br><span class="line">    test_y=labels[val_idx]</span><br><span class="line">    <span class="built_in">print</span>(preds)</span><br><span class="line">    <span class="built_in">print</span>(test_y)</span><br><span class="line">    <span class="comment"># test_y=test_y*labels.std(0)+labels.mean(0)</span></span><br><span class="line">    <span class="comment"># preds=preds*labels.std(0)+labels.mean(0)</span></span><br><span class="line">    score=mean_squared_error(test_y,preds)</span><br><span class="line">    <span class="built_in">print</span>(score, end=<span class="string">&#x27;\n\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Lightgbm"><a href="#Lightgbm" class="headerlink" title="Lightgbm"></a>Lightgbm</h1><h2 id="Binary-Classification-1"><a href="#Binary-Classification-1" class="headerlink" title="Binary Classification"></a>Binary Classification</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> StratifiedKFold</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_auc_score,precision_score</span><br><span class="line"><span class="keyword">import</span> xgboost <span class="keyword">as</span> xgb</span><br><span class="line"><span class="keyword">import</span> lightgbm <span class="keyword">as</span> lgb</span><br><span class="line"></span><br><span class="line">skfold=StratifiedKFold(n_splits=<span class="number">3</span>,random_state=<span class="number">2022</span>,shuffle=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> train_idx,val_idx <span class="keyword">in</span> skfold.split(all_data,labels):</span><br><span class="line">    params=&#123;</span><br><span class="line">        <span class="string">&#x27;objective&#x27;</span> : <span class="string">&#x27;binary&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;learning_rate&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">&#x27;n_estimators&#x27;</span> : <span class="number">10</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    gbm = lgb.LGBMClassifier(**params)</span><br><span class="line">    gbm.fit(all_data[train_idx], labels[train_idx], eval_set=[(all_data[train_idx], labels[train_idx])], eval_metric=<span class="string">&#x27;cross_entropy&#x27;</span>)</span><br><span class="line">    preds = gbm.predict(all_data[val_idx], num_iteration=gbm.best_iteration_)</span><br><span class="line">    <span class="comment"># precision 84 auc 59</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    test_y=labels[val_idx]</span><br><span class="line">    score=precision_score(test_y,preds)</span><br><span class="line">    <span class="built_in">print</span>(score)</span><br><span class="line">    score = roc_auc_score(test_y, preds)</span><br><span class="line">    <span class="built_in">print</span>(score, end=<span class="string">&#x27;\n\n&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="Regression-1"><a href="#Regression-1" class="headerlink" title="Regression"></a>Regression</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> StratifiedKFold</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_auc_score,precision_score</span><br><span class="line"><span class="keyword">import</span> xgboost <span class="keyword">as</span> xgb</span><br><span class="line"><span class="keyword">import</span> lightgbm <span class="keyword">as</span> lgb</span><br><span class="line"></span><br><span class="line">skfold=StratifiedKFold(n_splits=<span class="number">3</span>,random_state=<span class="number">2022</span>,shuffle=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> train_idx,val_idx <span class="keyword">in</span> skfold.split(all_data,labels):</span><br><span class="line">    params=&#123;</span><br><span class="line">        <span class="string">&#x27;objective&#x27;</span> : <span class="string">&#x27;regression&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;learning_rate&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">&#x27;n_estimators&#x27;</span> : <span class="number">40</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    gbm = lgb.LGBMRegressor(**params)</span><br><span class="line">    gbm.fit(all_data[train_idx], labels_norm[train_idx], eval_set=[(all_data[train_idx], labels_norm[train_idx])])</span><br><span class="line">    preds = gbm.predict(all_data[val_idx], num_iteration=gbm.best_iteration_)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    test_y=labels[val_idx]</span><br><span class="line">    <span class="built_in">print</span>(preds)</span><br><span class="line">    <span class="built_in">print</span>(test_y)</span><br><span class="line">    test_y=test_y*labels.std(<span class="number">0</span>)+labels.mean(<span class="number">0</span>)</span><br><span class="line">    preds=preds*labels.std(<span class="number">0</span>)+labels.mean(<span class="number">0</span>)</span><br><span class="line">    score=mean_squared_error(test_y,preds)</span><br><span class="line">    <span class="built_in">print</span>(score, end=<span class="string">&#x27;\n\n&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>YOLOv5 quick start</title>
      <link href="/2020/09/04/yolov5_takeaway/"/>
      <url>/2020/09/04/yolov5_takeaway/</url>
      
        <content type="html"><![CDATA[<h1 id="Takeaways"><a href="#Takeaways" class="headerlink" title="Takeaways"></a>Takeaways</h1><p>éœ€è¦è§„æ•´ä¸¤ä¸ªæ–‡ä»¶<code>xx/images/</code>å’Œ<code>xx/labels</code>ï¼Œå…¶ä¸­é‡Œé¢å †æ”¾å¯ä»¥å †æ”¾æŒ‡å‘æ–‡ä»¶çš„txtï¼Œåˆ†åˆ«éƒ½æ˜¯<code>train.txt</code>å’Œ<code>val.txt</code>ã€‚</p><p>è®­ç»ƒä½¿ç”¨yoloé¡¹ç›®ä¸­<code>train.py</code>ï¼Œå…¶å‘½ä»¤ä¸­dataé€‰é¡¹éœ€è¦yamlï¼Œè¿›è¡Œæ•°æ®é›†çš„æŒ‡å‘å’Œè¯´æ˜ã€‚ä¸€å®šè¦ä¿è¯yamlçš„è·¯å¾„ä¸æˆ‘ä»¬å¤„ç†çš„æ•°æ®é›†çš„è·¯å¾„ç›¸åŒã€‚</p><p>æ‰€æœ‰è¿è¡Œåçš„ç»“æœï¼Œéƒ½ä¼šåœ¨é¡¹ç›®çš„runsæ–‡ä»¶å¤¹ä¸­ã€‚</p><h1 id="å¿«é€Ÿä¸Šæ‰‹-https-docs-ultralytics-com-quick-start"><a href="#å¿«é€Ÿä¸Šæ‰‹-https-docs-ultralytics-com-quick-start" class="headerlink" title="å¿«é€Ÿä¸Šæ‰‹^[https://docs.ultralytics.com/quick-start/]"></a>å¿«é€Ÿä¸Šæ‰‹^[<a href="https://docs.ultralytics.com/quick-start/">https://docs.ultralytics.com/quick-start/</a>]</h1><p>æ€»å‚è€ƒï¼š<a href="https://docs.ultralytics.com/tutorials/training-tips-best-results/">https://docs.ultralytics.com/tutorials/training-tips-best-results/</a> </p><h1 id="Inference"><a href="#Inference" class="headerlink" title="Inference"></a>Inference</h1><ul><li>ä¸¤ç§æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯è‡ªè¡Œä¸‹è½½modelæºç ï¼Œä½¿ç”¨detect.py.  <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python .\detect.py --weights <span class="string">&quot;weights/yolov5s.pt&quot;</span> --source <span class="string">&quot;data/images/bus.jpg&quot;</span></span><br></pre></td></tr></table></figure></li><li>å¦ä¸€ä¸ªæ˜¯é€šè¿‡<code>torch.hub</code>  <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">import</span> torch</span><br><span class="line"></span><br><span class="line"><span class="comment"># Model</span></span><br><span class="line">model = torch.hub.load(<span class="string">&#x27;ultralytics/yolov5&#x27;</span>, <span class="string">&#x27;yolov5s&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Images</span></span><br><span class="line"><span class="built_in">dir</span> = <span class="string">&#x27;https://github.com/ultralytics/yolov5/raw/master/data/images/&#x27;</span></span><br><span class="line">imgs = [<span class="built_in">dir</span> + f <span class="keyword">for</span> f <span class="keyword">in</span> (<span class="string">&#x27;zidane.jpg&#x27;</span>, <span class="string">&#x27;bus.jpg&#x27;</span>)]  <span class="comment"># batch of images</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Inference</span></span><br><span class="line">results = model(imgs)</span><br><span class="line">results.<span class="built_in">print</span>()  <span class="comment"># or .show(), .save()</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Training"><a href="#Training" class="headerlink" title="Training"></a>Training</h1></li></ul><h2 id="ç¼–å†™yamlæ–‡ä»¶"><a href="#ç¼–å†™yamlæ–‡ä»¶" class="headerlink" title="ç¼–å†™yamlæ–‡ä»¶"></a>ç¼–å†™yamlæ–‡ä»¶</h2><p>é¦–å…ˆéœ€è¦ä¸€ä¸ªyamlæ–‡ä»¶ï¼Œæ”¾åœ¨<code>data</code>æ–‡ä»¶å¤¹ä¸‹ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š<br>ç¬¬ä¸€è¡Œå…¶å®æ˜¯å­˜æ”¾è·¯å¾„åçš„æ–‡ä»¶ï¼Œæ–‡ä»¶çš„æ¯ä¸€è¡Œå¯ä»¥æœ‰ä¸‰ç§å½¢å¼ï¼Œæ³¨é‡Šå·²ç»ç»™å‡ºã€‚</p><ul><li>ä¸€ç§æ˜¯ç›´æ¥æŠŠç›®å½•ç»™å‡ºï¼Œç›®å½•é‡Œé¢æ”¾æœ‰å›¾ç‰‡+æ ‡ç­¾</li><li>ä¸€ç§æ˜¯ä»¥txtå½¢å¼ç»™å‡ºï¼Œtxté‡Œé¢æœ‰å›¾ç‰‡/labelçš„è·¯å¾„</li><li>ä¸€ç§æ˜¯å¤šç§è·¯å¾„åŒæ—¶ç»™å‡º<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># train and val data as 1) directory: path/images/, 2) file: path/images.txt, or 3) list: [path1/images/, path2/images/]</span></span><br><span class="line"><span class="attr">train:</span> <span class="string">../coco128/images/train2017/</span></span><br><span class="line"><span class="attr">val:</span> <span class="string">../coco128/images/train2017/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># number of classes</span></span><br><span class="line"><span class="attr">nc:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># class names</span></span><br><span class="line"><span class="attr">names:</span> [<span class="string">&#x27;person&#x27;</span>, <span class="string">&#x27;bicycle&#x27;</span>, <span class="string">&#x27;car&#x27;</span>, <span class="string">&#x27;motorcycle&#x27;</span>, <span class="string">&#x27;airplane&#x27;</span>, <span class="string">&#x27;bus&#x27;</span>, <span class="string">&#x27;train&#x27;</span>, <span class="string">&#x27;truck&#x27;</span>, <span class="string">&#x27;boat&#x27;</span>, <span class="string">&#x27;traffic light&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;fire hydrant&#x27;</span>, <span class="string">&#x27;stop sign&#x27;</span>, <span class="string">&#x27;parking meter&#x27;</span>, <span class="string">&#x27;bench&#x27;</span>, <span class="string">&#x27;bird&#x27;</span>, <span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;dog&#x27;</span>, <span class="string">&#x27;horse&#x27;</span>, <span class="string">&#x27;sheep&#x27;</span>, <span class="string">&#x27;cow&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;elephant&#x27;</span>, <span class="string">&#x27;bear&#x27;</span>, <span class="string">&#x27;zebra&#x27;</span>, <span class="string">&#x27;giraffe&#x27;</span>, <span class="string">&#x27;backpack&#x27;</span>, <span class="string">&#x27;umbrella&#x27;</span>, <span class="string">&#x27;handbag&#x27;</span>, <span class="string">&#x27;tie&#x27;</span>, <span class="string">&#x27;suitcase&#x27;</span>, <span class="string">&#x27;frisbee&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;skis&#x27;</span>, <span class="string">&#x27;snowboard&#x27;</span>, <span class="string">&#x27;sports ball&#x27;</span>, <span class="string">&#x27;kite&#x27;</span>, <span class="string">&#x27;baseball bat&#x27;</span>, <span class="string">&#x27;baseball glove&#x27;</span>, <span class="string">&#x27;skateboard&#x27;</span>, <span class="string">&#x27;surfboard&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;tennis racket&#x27;</span>, <span class="string">&#x27;bottle&#x27;</span>, <span class="string">&#x27;wine glass&#x27;</span>, <span class="string">&#x27;cup&#x27;</span>, <span class="string">&#x27;fork&#x27;</span>, <span class="string">&#x27;knife&#x27;</span>, <span class="string">&#x27;spoon&#x27;</span>, <span class="string">&#x27;bowl&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sandwich&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;broccoli&#x27;</span>, <span class="string">&#x27;carrot&#x27;</span>, <span class="string">&#x27;hot dog&#x27;</span>, <span class="string">&#x27;pizza&#x27;</span>, <span class="string">&#x27;donut&#x27;</span>, <span class="string">&#x27;cake&#x27;</span>, <span class="string">&#x27;chair&#x27;</span>, <span class="string">&#x27;couch&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;potted plant&#x27;</span>, <span class="string">&#x27;bed&#x27;</span>, <span class="string">&#x27;dining table&#x27;</span>, <span class="string">&#x27;toilet&#x27;</span>, <span class="string">&#x27;tv&#x27;</span>, <span class="string">&#x27;laptop&#x27;</span>, <span class="string">&#x27;mouse&#x27;</span>, <span class="string">&#x27;remote&#x27;</span>, <span class="string">&#x27;keyboard&#x27;</span>, </span><br><span class="line">        <span class="string">&#x27;cell phone&#x27;</span>, <span class="string">&#x27;microwave&#x27;</span>, <span class="string">&#x27;oven&#x27;</span>, <span class="string">&#x27;toaster&#x27;</span>, <span class="string">&#x27;sink&#x27;</span>, <span class="string">&#x27;refrigerator&#x27;</span>, <span class="string">&#x27;book&#x27;</span>, <span class="string">&#x27;clock&#x27;</span>, <span class="string">&#x27;vase&#x27;</span>, <span class="string">&#x27;scissors&#x27;</span>, </span><br><span class="line">        <span class="string">&#x27;teddy bear&#x27;</span>, <span class="string">&#x27;hair drier&#x27;</span>, <span class="string">&#x27;toothbrush&#x27;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h2 id="è·å¾—æ ‡ç­¾"><a href="#è·å¾—æ ‡ç­¾" class="headerlink" title="è·å¾—æ ‡ç­¾"></a>è·å¾—æ ‡ç­¾</h2><p>å¯ä»¥ä½¿ç”¨CVATã€ makesense.aiã€ Labelboxã€Labelimgç­‰ç­‰å·¥å…·æ‰“æ ‡ã€‚</p><h2 id="è½¬åŒ–labelæ ¼å¼ï¼ˆå¦‚æœéœ€è¦ï¼‰"><a href="#è½¬åŒ–labelæ ¼å¼ï¼ˆå¦‚æœéœ€è¦ï¼‰" class="headerlink" title="è½¬åŒ–labelæ ¼å¼ï¼ˆå¦‚æœéœ€è¦ï¼‰"></a>è½¬åŒ–labelæ ¼å¼ï¼ˆå¦‚æœéœ€è¦ï¼‰</h2><p>labelæ ¼å¼ä¸€èˆ¬æœ‰ä¸¤ç§ï¼Œä¸€ä¸ªæ˜¯xmlï¼Œä¸€ä¸ªæ˜¯txtã€‚<br>txtæ ¼å¼æ˜¯ï¼šæ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªobjectï¼Œä»¥<code>class x_center y_center width height</code>è¡¨ç¤ºï¼Œyoloç³»åˆ—ä½¿ç”¨çš„æ˜¯txtæ ¼å¼ã€‚<br>xmlæ ¼å¼å®ä¾‹ï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; ?&gt;&lt;annotation&gt;</span><br><span class="line">  &lt;filename&gt;helmet_10827.jpg&lt;/filename&gt;</span><br><span class="line">  &lt;size&gt;</span><br><span class="line">    &lt;width&gt;1920&lt;/width&gt;</span><br><span class="line">    &lt;height&gt;1080&lt;/height&gt;</span><br><span class="line">    &lt;depth&gt;3&lt;/depth&gt;</span><br><span class="line">  &lt;/size&gt;</span><br><span class="line">  &lt;object&gt;</span><br><span class="line">    &lt;name&gt;hat&lt;/name&gt;</span><br><span class="line">    &lt;bndbox&gt;</span><br><span class="line">      &lt;xmin&gt;1227&lt;/xmin&gt;</span><br><span class="line">      &lt;ymin&gt;385&lt;/ymin&gt;</span><br><span class="line">      &lt;xmax&gt;1288&lt;/xmax&gt;</span><br><span class="line">      &lt;ymax&gt;446&lt;/ymax&gt;</span><br><span class="line">    &lt;/bndbox&gt;</span><br><span class="line">  &lt;/object&gt;</span><br><span class="line">  &lt;object&gt;</span><br><span class="line">    &lt;name&gt;person&lt;/name&gt;</span><br><span class="line">    &lt;bndbox&gt;</span><br><span class="line">      &lt;xmin&gt;1161&lt;/xmin&gt;</span><br><span class="line">      &lt;ymin&gt;377&lt;/ymin&gt;</span><br><span class="line">      &lt;xmax&gt;1324&lt;/xmax&gt;</span><br><span class="line">      &lt;ymax&gt;604&lt;/ymax&gt;</span><br><span class="line">    &lt;/bndbox&gt;</span><br><span class="line">  &lt;/object&gt;</span><br><span class="line">&lt;/annotation&gt;</span><br></pre></td></tr></table></figure></p><p>xmlè½¬txtå¯ä»¥ç”¨ä»¥ä¸‹<strong>ç¤ºä¾‹</strong>ä»£ç ^[<a href="https://docs.cvmart.net/#/best_practice_for_newbie?id=jump1]è½¬åŒ–ï¼š">https://docs.cvmart.net/#/best_practice_for_newbie?id=jump1]è½¬åŒ–ï¼š</a><br>xmlè½¬txt<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> listdir, getcwd</span><br><span class="line"><span class="keyword">from</span> os.path <span class="keyword">import</span> join</span><br><span class="line"></span><br><span class="line">sets=[<span class="string">&#x27;train&#x27;</span>, <span class="string">&#x27;val&#x27;</span>, <span class="string">&#x27;test&#x27;</span>]</span><br><span class="line">classes = [<span class="string">&#x27;person&#x27;</span>, <span class="string">&#x27;hat&#x27;</span>,<span class="string">&#x27;head&#x27;</span>]</span><br><span class="line"></span><br><span class="line">abs_path = os.getcwd()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert</span>(<span class="params">size, box</span>):</span><br><span class="line">    dw = <span class="number">1.</span>/(size[<span class="number">0</span>])</span><br><span class="line">    dh = <span class="number">1.</span>/(size[<span class="number">1</span>])</span><br><span class="line">    x = (box[<span class="number">0</span>] + box[<span class="number">1</span>])/<span class="number">2.0</span> - <span class="number">1</span></span><br><span class="line">    y = (box[<span class="number">2</span>] + box[<span class="number">3</span>])/<span class="number">2.0</span> - <span class="number">1</span></span><br><span class="line">    w = box[<span class="number">1</span>] - box[<span class="number">0</span>]</span><br><span class="line">    h = box[<span class="number">3</span>] - box[<span class="number">2</span>]</span><br><span class="line">    x = x*dw</span><br><span class="line">    w = w*dw</span><br><span class="line">    y = y*dh</span><br><span class="line">    h = h*dh</span><br><span class="line">    <span class="keyword">return</span> (x,y,w,h)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_annotation</span>(<span class="params">image_id</span>):</span><br><span class="line">    in_file = <span class="built_in">open</span>(<span class="string">&#x27;/project/train/src_repo/dataset/Annotations/%s.xml&#x27;</span>%( image_id))</span><br><span class="line">    out_file = <span class="built_in">open</span>(<span class="string">&#x27;/project/train/src_repo/dataset/labels/%s.txt&#x27;</span>%(image_id), <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    tree=ET.parse(in_file)</span><br><span class="line">    root = tree.getroot()</span><br><span class="line">    size = root.find(<span class="string">&#x27;size&#x27;</span>)</span><br><span class="line">    w = <span class="built_in">int</span>(size.find(<span class="string">&#x27;width&#x27;</span>).text)</span><br><span class="line">    h = <span class="built_in">int</span>(size.find(<span class="string">&#x27;height&#x27;</span>).text)</span><br><span class="line">    <span class="keyword">for</span> obj <span class="keyword">in</span> root.<span class="built_in">iter</span>(<span class="string">&#x27;object&#x27;</span>):</span><br><span class="line">        <span class="comment">#difficult = obj.find(&#x27;difficult&#x27;).text</span></span><br><span class="line">        cls = obj.find(<span class="string">&#x27;name&#x27;</span>).text</span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> classes :</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        cls_id = classes.index(cls)</span><br><span class="line">        xmlbox = obj.find(<span class="string">&#x27;bndbox&#x27;</span>)</span><br><span class="line">        b = (<span class="built_in">float</span>(xmlbox.find(<span class="string">&#x27;xmin&#x27;</span>).text), <span class="built_in">float</span>(xmlbox.find(<span class="string">&#x27;xmax&#x27;</span>).text), <span class="built_in">float</span>(xmlbox.find(<span class="string">&#x27;ymin&#x27;</span>).text), <span class="built_in">float</span>(xmlbox.find(<span class="string">&#x27;ymax&#x27;</span>).text))</span><br><span class="line">        bb = convert((w,h), b)</span><br><span class="line">        out_file.write(<span class="built_in">str</span>(cls_id) + <span class="string">&quot; &quot;</span> + <span class="string">&quot; &quot;</span>.join([<span class="built_in">str</span>(a) <span class="keyword">for</span> a <span class="keyword">in</span> bb]) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> image_set <span class="keyword">in</span> sets:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;/project/train/src_repo/dataset/labels/&#x27;</span>):</span><br><span class="line">        os.makedirs(<span class="string">&#x27;/project/train/src_repo/dataset/labels/&#x27;</span>)</span><br><span class="line">    image_ids = <span class="built_in">open</span>(<span class="string">&#x27;/project/train/src_repo/dataset/ImageSets/Main/%s.txt&#x27;</span>%(image_set)).read().strip().split()</span><br><span class="line">    list_file = <span class="built_in">open</span>(<span class="string">&#x27;/project/train/src_repo/dataset/%s.txt&#x27;</span>%(image_set), <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> image_id <span class="keyword">in</span> image_ids:</span><br><span class="line">        list_file.write(<span class="string">&#x27;/project/train/src_repo/dataset/images/%s.jpg\n&#x27;</span>%(image_id))</span><br><span class="line">        convert_annotation(image_id)</span><br><span class="line">    list_file.close()</span><br></pre></td></tr></table></figure></p><h2 id="æ•´ç†ç›®å½•"><a href="#æ•´ç†ç›®å½•" class="headerlink" title="æ•´ç†ç›®å½•"></a>æ•´ç†ç›®å½•</h2><p>ç›®å½•ç»“æ„åº”è¯¥æˆè¿™ä¸ªæ ·å­ï¼š<br><img src="https://user-images.githubusercontent.com/26833433112467887-e18a0980-8d67-11eb-93af-6505620ff8aa.png" alt="è¿™æ˜¯å›¾ç‰‡"></p><p>datasetå•ç‹¬ä¸€ä¸ªç›®å½•ï¼Œç›®å½•ä¸‹æœ‰imageså’Œlabelsä¸¤ä¸ªç›®å½•ï¼Œæ¯ä¸ªç›®å½•ä¸‹æœ‰trainå’Œvalidã€‚</p><h2 id="Training-1"><a href="#Training-1" class="headerlink" title="Training"></a>Training</h2><p>åœ¨ä¸‹è½½çš„æºç é‡Œï¼Œæœ‰<code>train.py</code>ã€‚<br>åªéœ€æŒ‰ç…§ç¤ºä¾‹ï¼š<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Train YOLOv5s on COCO128 for 5 epochs</span></span><br><span class="line">$ python train.py --img <span class="number">640</span> --batch <span class="number">16</span> --epochs <span class="number">5</span> --data coco128.yaml --weights yolov5s.pt</span><br></pre></td></tr></table></figure><br>è®­ç»ƒç»“æœä¼šä¿å­˜åœ¨é¡¹ç›®çš„<code>runs/train/</code>ã€‚</p><h2 id="æŸ¥çœ‹è®­ç»ƒã€å¯è§†åŒ–"><a href="#æŸ¥çœ‹è®­ç»ƒã€å¯è§†åŒ–" class="headerlink" title="æŸ¥çœ‹è®­ç»ƒã€å¯è§†åŒ–"></a>æŸ¥çœ‹è®­ç»ƒã€å¯è§†åŒ–</h2><p>å¯ä»¥ç”¨wandbå’Œtensorboardï¼Œæ•™ç¨‹æ¨èä½¿ç”¨wandbã€‚</p><h3 id="wandb"><a href="#wandb" class="headerlink" title="wandb"></a>wandb</h3><p>å¯ä»¥ç”¨wandbï¼Œ<code>pip install wandb</code>ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å°±å¯ä»¥åœ¨ <a href="https://wandb.ai">https://wandb.ai</a> ä¸­çœ‹åˆ°ç»“æœã€‚<br>ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼Œlogä¼šè¢«é»˜è®¤çš„æ”¾åœ¨<code>runs/train</code>ã€‚</p><h3 id="tensorboard"><a href="#tensorboard" class="headerlink" title="tensorboard"></a>tensorboard</h3><p>è¿™ä¸ªéœ€è¦è‡ªè¡Œä¿®æ”¹ä»£ç ï¼Œåœ¨åˆé€‚çš„ä½ç½®åŠ å…¥tbï¼Œè®°å½•æ•°æ®ã€‚</p><h1 id="æ›´é«˜è®­ç»ƒç»“æœtips"><a href="#æ›´é«˜è®­ç»ƒç»“æœtips" class="headerlink" title="æ›´é«˜è®­ç»ƒç»“æœtips"></a>æ›´é«˜è®­ç»ƒç»“æœtips</h1><h2 id="æ•°æ®é›†æ”¹è¿›ç‚¹"><a href="#æ•°æ®é›†æ”¹è¿›ç‚¹" class="headerlink" title="æ•°æ®é›†æ”¹è¿›ç‚¹"></a>æ•°æ®é›†æ”¹è¿›ç‚¹</h2><ul><li>å…³äºæ¯ç±»çš„å›¾ç‰‡ï¼šæ¯ä¸€ç±»æœ€å¥½æ˜¯â‰¥1.5kçš„å›¾ç‰‡ã€‚</li><li>æ¯ç±»ç‰©ä½“æœ€å¥½æ˜¯â‰¥10k. å¹¶ä¸”ç‰©ä½“è¦å…·æœ‰ä»£è¡¨æ€§ã€‚çœŸå®åœºæ™¯ä¸‹ï¼Œæ¨èä½¿ç”¨ä¸åŒæ—¶é—´æ®µã€ä¸åŒå­£èŠ‚ã€ä¸åŒè§’åº¦ã€ä¸åŒå…‰ç…§ã€ä¸åŒå¤©æ°”ã€ä¸åŒé‡‡é›†æºçš„åŒä¸€ç‰©ä½“ï¼Œåšä¸ºè®­ç»ƒæ•°æ®ã€‚</li><li>Label consistency. All instances of all classes in all images must be labelled. Partial labelling will not work.</li><li>Label accuracy. Labels must closely enclose each object. No space should exist between an object and itâ€™s bounding box. No objects should be missing a label.</li><li>Background images. Background images are images with no objects that are added to a dataset to reduce False Positives (FP). We recommend about 0-10% background images to help reduce FPs (COCO has 1000 background images for reference, 1% of the total).</li></ul><h2 id="æ¨¡å‹é€‰æ‹©"><a href="#æ¨¡å‹é€‰æ‹©" class="headerlink" title="æ¨¡å‹é€‰æ‹©"></a>æ¨¡å‹é€‰æ‹©</h2><p>yoloæä¾›äº†å¤šç§ä¸åŒå¤§å°çš„æ¨¡å‹ï¼Œå¤§æ¨¡å‹å¾€å¾€èƒ½æ›´å¥½çš„ç»“æœã€‚<br><img src="https://user-images.githubusercontent.com/26833433/103595982-ab986000-4eb1-11eb-8c57-4726261b0a88.png" alt=""></p><ul><li>pretrainå¾€å¾€åœ¨ä¸­å°å‹æ•°æ®é›†ä¸Šã€‚  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python train.py --data custom.yaml --weights yolov5s.pt</span><br><span class="line">                                         yolov5m.pt</span><br><span class="line">                                         yolov5l.pt</span><br><span class="line">                                         yolov5x.pt</span><br><span class="line">                                         custom_pretrained.pt</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>train from scratchå¾€å¾€åœ¨å¤§æ•°æ®é›†ä¸Šã€‚  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python train.py --data custom.yaml --weights &#x27;&#x27; --cfg yolov5s.yaml</span><br><span class="line">                                                  yolov5m.yaml</span><br><span class="line">                                                  yolov5l.yaml</span><br><span class="line">                                                  yolov5x.yaml</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h2 id="è®­ç»ƒå‚æ•°"><a href="#è®­ç»ƒå‚æ•°" class="headerlink" title="è®­ç»ƒå‚æ•°"></a>è®­ç»ƒå‚æ•°</h2><p>Training Settings</p><p>Before modifying anything, first train with default settings to establish a performance baseline. A full list of train.py settings can be found in the train.py argparser.</p><ul><li><strong>Epochs</strong>. Start with 300 epochs. If this overfits early then you can reduce epochs. If overfitting does not occur after 300 epochs, train longer, i.e. 600, 1200 etc epochs.</li><li><strong>Image size</strong>. COCO trains at native resolution of <code>--img 640</code>, though due to the high amount of small objects in the dataset it can benefit from training at higher resolutions such as <code>--img 1280</code>. If there are many <strong>small objects</strong> then custom datasets will benefit from training at native or higher resolution. Best inference results are obtained at the same â€”img as the training was run at, i.e. if you train at <code>--img 1280</code> you should also test and detect at <code>--img 1280</code>.</li><li><strong>Batch size</strong>. Use the largest <code>--batch-size</code> that your hardware allows for. Small batch sizes produce poor batchnorm statistics and should be avoided.</li><li><strong>Hyperparameters</strong>. Default hyperparameters are in <a href="https://github.com/ultralytics/yolov5/blob/master/data/hyp.scratch.yaml">hyp.scratch.yaml</a>. We recommend you train with default hyperparameters first before thinking of modifying any. In general, <em>increasing augmentation hyperparameters will reduce and delay overfitting, allowing for longer trainings and higher final mAP</em>. Reduction in loss component gain hyperparameters like <code>hyp[&#39;obj&#39;]</code> will help reduce overfitting in those specific loss components. For an automated method of optimizing these hyperparameters, see our <a href="https://github.com/ultralytics/yolov5/issues/607">Hyperparameter Evolution Tutorial</a>.</li></ul><p>å‚è€ƒ^[<a href="https://docs.ultralytics.com/tutorials/train-custom-datasets/">https://docs.ultralytics.com/tutorials/train-custom-datasets/</a>]</p>]]></content>
      
      
      
        <tags>
            
            <tag> cv, object detection </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>moving average</title>
      <link href="/2020/09/01/moving_average/"/>
      <url>/2020/09/01/moving_average/</url>
      
        <content type="html"><![CDATA[<h2 id="Exponentially-weighted-averages"><a href="#Exponentially-weighted-averages" class="headerlink" title="Exponentially weighted averages "></a>Exponentially weighted averages </h2><script type="math/tex; mode=display">Vt=Î²Vtâˆ’1âˆ’(1âˆ’Î²)Vt</script><p>where Î² ranges from 0 to 1.<br>This equation enables you to make average of 11âˆ’Î²</p><p>daysâ€™ data, which will make the data plot much smoother.</p><p>example:<br><a href="https://www.bilibili.com/video/av49445369?p=60">https://www.bilibili.com/video/av49445369?p=60</a><br>result:<br>pic<br>where the red line is the smoother plot and the blue ones are the original data plot.</p><p><a href="https://zhuanlan.zhihu.com/p/29895933">https://zhuanlan.zhihu.com/p/29895933</a><br>So itâ€™s just a weighted average, and it can perform smoothening.<br>Improvementâ€“Bias correction</p><p>At early stage, if we use standard equation may get the purple line in the picture below, because it lack former data to be averaged.<br>pic<br>To eliminate this problem, perform the method in red rectangle on the picture in early stage.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>measure the contribution:shaply value</title>
      <link href="/2020/09/01/shaply/"/>
      <url>/2020/09/01/shaply/</url>
      
        <content type="html"><![CDATA[<p>Measure Contribution of Participants in Federated Learning<br>2020-03-27</p><p><a href="https://arxiv.org/pdf/1909.08525v1.pdf">Paper link</a></p><h1 id="BASIC"><a href="#BASIC" class="headerlink" title="BASIC"></a>BASIC</h1><p>backgroud: federated learning<br>two measure methods exist, deletion <a href="https://www.ime.usp.br/~abe/lista/pdfWiH1zqnMHo.pdf">diagnostics</a> and <a href="https://arxiv.org/pdf/1703.04730.pdf">influence functions</a></p><h1 id="SHAPLEY-VALUE-amp-MARIGINAL-CONTRIBUTION"><a href="#SHAPLEY-VALUE-amp-MARIGINAL-CONTRIBUTION" class="headerlink" title="SHAPLEY VALUE &amp; MARIGINAL CONTRIBUTION"></a>SHAPLEY VALUE &amp; MARIGINAL CONTRIBUTION</h1><p>itâ€™s used to split profit earned by all participants.</p><h2 id="Example"><a href="#Example" class="headerlink" title="Example:"></a>Example:</h2><p>We need to kill 500 monsters in total. A alone can kill 100; B alone can kill 125; C alone can kill 50. A and B together can kill 270; B and C together can kill 350; A and C together can kill 375; A and B and C together can kill 500 in total.<br>We denote what mentioned above as:<br>v(1)=100;</p><p>v(2)=125; v(3)=50;<br>v(1,2)=270; v(2,3)=350; v(1,3)=375;<br>v(1,2,3)=500;</p><p>Note that the task can only be accomplished by three people.<br>possible cases might be 6 in total:<br>A invites B to make a group S and then invites C.<br>A invites C to make a group S and then invites B.<br>etc etc.</p><h1 id="Marginal-Contribution"><a href="#Marginal-Contribution" class="headerlink" title="Marginal Contribution"></a>Marginal Contribution</h1><p>The marginal contribution splitted of this 6 cases should be calculated as this as shown in the table.<br>image<br>so the marginal contribution is formulated as: $Î´_i(S)=v(S\cup i)âˆ’v(S)$<br>, where $Î´$ denote the influence/contribution factor, $Î´_i(S)$ denotes the ith participantâ€™s contribution to group S.<br>From the discussion we can know that the order of the participants really matters in term of marginal contribution.</p><h1 id="Shapley-Value"><a href="#Shapley-Value" class="headerlink" title="Shapley Value"></a>Shapley Value</h1><p>shapley value takes high importance on marginal contribution(è¾¹é™…è´¡çŒ® in chinese), which is formulated as</p><script type="math/tex; mode=display">Sh(S,i)=\frac{Î£_{râˆˆR}Î´_i(r)}{|Ag|!}</script><p>where $|Ag|$ denotes the number of agants who participates; R denotes the set of all possible cases, r denotes one specific case that belong to whole set R;<br>According to the shapley value equation, we calculate agantsâ€™ value as followed:<br>1ï¼š 16(100+100+145+150+325+150)=9706<br>2ï¼š 16(170+125+125+125+125+300)=9706<br>3ï¼š 16(230+275+230+225+50+50)=10606</p><p>1 2 3 total is 500.<br>and then they can split the profit according to the shapley value.</p><h1 id="PAPER-METHOD"><a href="#PAPER-METHOD" class="headerlink" title="PAPER METHOD"></a>PAPER METHOD</h1><h2 id="Horizontal-Measurement"><a href="#Horizontal-Measurement" class="headerlink" title="Horizontal Measurement"></a>Horizontal Measurement</h2><p>Deletion diagnostics is intuitive. Retrain the model each time with an instance omitted from training dataset and measure how much the prediction of retrained model changes.</p><p>Suppose we omit the $i$th instance, or rather one piece of data, influence is formulated as:</p><script type="math/tex; mode=display">Influence(i)=\frac1nÎ£^n_{j=i}|predjâˆ’predâˆ’ij|</script><p>And any dataset had many instance, so the dataset influence can be discribed as:</p><script type="math/tex; mode=display">Influence(D)=Î£_{iâˆˆD}Influence(D_i)</script><p>where $Di$ means the $i$th instance in dataset.</p><h2 id="Vertical-Measurement"><a href="#Vertical-Measurement" class="headerlink" title="Vertical Measurement"></a>Vertical Measurement</h2><p>coeffient<br>Questions tbd: what is situational importance?<br>Itâ€™s an ancient question coming up a long time ago, and thereâ€™re pretty many paper about this question. Most of them applied shapley value as measurement to get vertical FML contribution of each party.</p><p>We first take a easy example and then we generalize the situation.</p><h2 id="Individual-Feature-Shaley-Value"><a href="#Individual-Feature-Shaley-Value" class="headerlink" title="Individual Feature Shaley Value"></a>Individual Feature Shaley Value</h2><p>Note: we are now in INSTANCE level! We are talking about ONE SINGLE INSTANCE, one piece of data.<br>Consider an instance with total n features, what is the contribution of one specific feature value?<br>Suppose to calculate the contribution of the ith<br>feature, we go like this:</p><script type="math/tex; mode=display">Ï•_i(x)=Î£_{QâˆˆSâˆ–i}\frac{|Q|!(|S|âˆ’|Q|âˆ’1)!}{|S|!}(Î”_{Q\cup i}âˆ’Î”_Q)</script><p>where S is the index set of all feature, Q is a index subset, |.| denotes the number of . .<br>By observation, we can see that right part of the equation is the influence difference between subset with ith and subset without ith</p><p>while the left part is just a coeffient to average the influence.</p><h2 id="Dataset-Feature-Shaley-Value"><a href="#Dataset-Feature-Shaley-Value" class="headerlink" title="Dataset Feature Shaley Value"></a>Dataset Feature Shaley Value</h2><p>We are coming into DATASET LEVEL.<br>Although the method mentioned above gives a strong sulotion to get contribution of individual feature, but with so many data in a dataset, computing has a exponential time complexity, making it infeasible to implement in practice.<br>An approximation with Monto-Carlo Sampling algorithm has been proposed in <a href="https://link.springer.com/article/10.1007/s10115-013-0679-x">this paper</a>:</p><script type="math/tex; mode=display">Ï•_i(x)=\frac1M\sum^M_{m=1}(f(x^m_{+i})âˆ’f(x^{m}_{âˆ’i}))</script><p>where $M$ is the iteration number, which is customized by user; $x^{m}<em>{âˆ’i}$ is subset with random feature replaced by randomly picked instance from dataset, and WITHOUT ith feature; $x^m</em>{+i}$ is everything the same as $x^{m}_{âˆ’i}$ but WITH ith feature.</p><p>To summarize, the sampling method helps simplify computing making it feasible to perform contribution algorithm in dataset level.</p><h2 id="Federated-Learning-Feature-Shaley-Value"><a href="#Federated-Learning-Feature-Shaley-Value" class="headerlink" title="Federated Learning Feature Shaley Value"></a>Federated Learning Feature Shaley Value</h2><p>This is the paper method proposed by the author.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>yolo example</title>
      <link href="/2020/09/01/yolo/"/>
      <url>/2020/09/01/yolo/</url>
      
        <content type="html"><![CDATA[<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment">#cv2.rectangle é€šè¿‡å¯¹è§’çº¿æ¥ç”»çŸ©å½¢ï¼Œå·¦ä¸Šåˆ°å³ä¸‹è¿™ä¸ªå¯¹è§’çº¿ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#load yolo</span></span><br><span class="line">base=<span class="string">r&quot;G:/Code/YOLO recognition/&quot;</span></span><br><span class="line">yolo_net = cv2.dnn.readNet(base + <span class="string">&quot;yolov3.weights&quot;</span>, base + <span class="string">&quot;yolov3.cfg&quot;</span>)</span><br><span class="line"><span class="comment">#load label</span></span><br><span class="line">classes=<span class="string">&#x27;whatever&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(base+<span class="string">&quot;coco.names&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">     classes=[line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> f]</span><br><span class="line"><span class="comment"># print(classes)</span></span><br><span class="line"></span><br><span class="line">layer_names = yolo_net.getLayerNames()</span><br><span class="line">output_layers = [layer_names[i[<span class="number">0</span>] - <span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> yolo_net.getUnconnectedOutLayers()]</span><br><span class="line">colors = np.random.uniform(<span class="number">0</span>, <span class="number">255</span>, size=(<span class="built_in">len</span>(classes), <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#load image</span></span><br><span class="line">img=cv2.imread(base+<span class="string">&quot;2.jpg&quot;</span>)</span><br><span class="line"><span class="comment"># img=cv2.resize(img,None,fx=0.4,fy=0.4)</span></span><br><span class="line">img_height, img_width, channel=img.shape</span><br><span class="line">cv2.imshow(<span class="string">&quot;original&quot;</span>,img)</span><br><span class="line">blob=cv2.dnn.blobFromImage(img,<span class="number">0.00392</span>,(<span class="number">416</span>,<span class="number">416</span>),(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>),<span class="literal">True</span>,crop=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># blob=blob.astype(np.uint8) this is for image show, if needed.</span></span><br><span class="line">yolo_net.setInput(blob)</span><br><span class="line">outs=yolo_net.forward(output_layers)</span><br><span class="line"><span class="comment">#except for confidence, what else does yolo output contain?</span></span><br><span class="line"><span class="comment">#for detection down below, detection[0] is centroid_x ratio, detection[1] is centroid_y ratio</span></span><br><span class="line"><span class="comment">#detection[2] is width ratio, detection[3] is height ratio.</span></span><br><span class="line"></span><br><span class="line">confidences=[]</span><br><span class="line">boxes=[]</span><br><span class="line">pred_indeces=[]</span><br><span class="line"><span class="comment">#show info on pic</span></span><br><span class="line"><span class="keyword">for</span> out <span class="keyword">in</span> outs:</span><br><span class="line">    <span class="keyword">for</span> detection <span class="keyword">in</span> out:</span><br><span class="line">        <span class="comment">#why after 5</span></span><br><span class="line">        scores=detection[<span class="number">5</span>:]</span><br><span class="line">        pred_index=np.argmax(scores)</span><br><span class="line">        confidence=scores[pred_index]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> confidence &gt; <span class="number">0.5</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;there is one!&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            center_x=<span class="built_in">int</span>(detection[<span class="number">0</span>] * img_width)</span><br><span class="line">            center_y=<span class="built_in">int</span>(detection[<span class="number">1</span>] * img_height)</span><br><span class="line">            rec_width= <span class="built_in">int</span>(detection[<span class="number">2</span>] * img_width)</span><br><span class="line">            rec_height= <span class="built_in">int</span>(detection[<span class="number">3</span>] * img_height)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># cv2.circle(img,(center_x,center_y),10,(0,0,255),2)</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">#rectangle coordinates beginning at left top side.</span></span><br><span class="line">            left_top_x=<span class="built_in">int</span>(center_x - rec_width / <span class="number">2</span>)</span><br><span class="line">            left_top_y=<span class="built_in">int</span>(center_y - rec_height / <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">            boxes.append([left_top_x, left_top_y, rec_width, rec_height])</span><br><span class="line">            pred_indeces.append(pred_index)</span><br><span class="line">            confidences.append(<span class="built_in">float</span>(confidence))</span><br><span class="line">            <span class="comment"># cv2.rectangle(img,(x,y),(x+w,y+h),(0,0,255),2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#NMSBoxes recieves only float type data, otherwise it returns nothing.</span></span><br><span class="line">indexes = cv2.dnn.NMSBoxes(boxes, confidences, <span class="number">0.5</span>, <span class="number">0.4</span>)</span><br><span class="line"></span><br><span class="line">font=cv2.FONT_HERSHEY_PLAIN</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(boxes)):</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> indexes:</span><br><span class="line">        left_top_x, left_top_y, rec_width, rec_height=boxes[i]</span><br><span class="line">        label=classes[pred_indeces[i]]</span><br><span class="line">        color=colors[i]</span><br><span class="line">        cv2.rectangle(img, (left_top_x, left_top_y), (left_top_x + rec_width, left_top_y + rec_height), color, <span class="number">2</span>)</span><br><span class="line">        cv2.putText(img, label, (left_top_x, left_top_y + <span class="number">30</span>), font, <span class="number">1</span>, color, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">cv2.imshow(<span class="string">&quot;detection&quot;</span>,img)</span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br><span class="line">cv2.destroyAllWindows()</span><br><span class="line"></span><br><span class="line">exit()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
